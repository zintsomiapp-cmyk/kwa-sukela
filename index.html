<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kwa Sukela â€” Interactive World</title>
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,600;0,700;1,300;1,600&family=Syne:wght@400;600;700;800&family=DM+Sans:wght@300;400;500&family=JetBrains+Mono:wght@300;400&display=swap" rel="stylesheet">
<style>
:root{
  --ink:#1B2A3A;--ink2:#22344A;--white:#fff;--paper:#F7FAFC;
  --orange:#CA5C08;--ora-l:#E87218;--ora-xl:#F5A040;
  --blue:#1A6EA8;--blu-l:#2E8FCC;--sky:#E8F5FF;
  --green:#1E8449;--gold:#E6B32A;--red:#C0392B;
  --n1:#C0392B;--n2:#E6B32A;--n3:#1B2A3A;--n4:#1E8449;--n5:#fff;--n6:#CA5C08;--n7:#2E8FCC;
  --savannah1:#FF6B35;--savannah2:#F7931E;--savannah3:#FFD700;--savannah4:#8B4513;
  --bd:rgba(27,42,58,.1);--i60:rgba(27,42,58,.6);--i35:rgba(27,42,58,.35);
}
*,*::before,*::after{margin:0;padding:0;box-sizing:border-box}
html{scroll-behavior:smooth;font-size:16px}
body{background:var(--white);color:var(--ink);font-family:'DM Sans',sans-serif;overflow-x:hidden;-webkit-font-smoothing:antialiased}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SAVANNAH INTRO ANIMATION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#intro{position:fixed;inset:0;z-index:9999;background:#0a0410;display:flex;align-items:center;justify-content:center;flex-direction:column;transition:opacity 1.2s ease,transform 1.2s ease}
#intro.hide{opacity:0;pointer-events:none;transform:translateY(-20px)}
#intro-canvas{position:absolute;inset:0;width:100%;height:100%}
#intro-logo{position:relative;z-index:2;text-align:center;opacity:0;transform:translateY(30px);transition:opacity 1.5s ease 2s,transform 1.5s ease 2s}
#intro-logo.show{opacity:1;transform:translateY(0)}
#intro-logo h1{font-family:'Cormorant Garamond',serif;font-size:clamp(2.8rem,6vw,5rem);font-weight:700;color:#fff;letter-spacing:-.02em;line-height:.9}
#intro-logo h1 em{font-style:italic;color:var(--ora-xl)}
#intro-logo p{font-family:'JetBrains Mono',monospace;font-size:.6rem;letter-spacing:.3em;text-transform:uppercase;color:rgba(255,255,255,.4);margin-top:.8rem}
#skip-btn{position:absolute;bottom:2rem;right:2rem;z-index:3;font-family:'JetBrains Mono',monospace;font-size:.55rem;letter-spacing:.15em;text-transform:uppercase;color:rgba(255,255,255,.3);border:1px solid rgba(255,255,255,.15);padding:.4rem 1rem;border-radius:2px;cursor:pointer;background:none;transition:color .2s,border-color .2s}
#skip-btn:hover{color:#fff;border-color:rgba(255,255,255,.5)}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   MAIN SITE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#site{opacity:0;transition:opacity 1s ease}
#site.show{opacity:1}

/* NAV */
nav{position:sticky;top:0;z-index:500;background:rgba(255,255,255,.97);backdrop-filter:blur(16px);border-bottom:1px solid var(--bd)}
.nstrip{height:5px;background:repeating-linear-gradient(90deg,var(--n1) 0,var(--n1) 14.28%,var(--n2) 14.28%,var(--n2) 28.57%,var(--n3) 28.57%,var(--n3) 42.85%,var(--n4) 42.85%,var(--n4) 57.14%,var(--n5) 57.14%,var(--n5) 71.42%,var(--n6) 71.42%,var(--n6) 85.71%,var(--n7) 85.71%,var(--n7) 100%)}
.nav-w{max-width:1280px;margin:0 auto;padding:.7rem 2rem;display:flex;justify-content:space-between;align-items:center;gap:1rem}
.logo{font-family:'Cormorant Garamond',serif;font-weight:700;font-size:1.2rem;color:var(--ink);text-decoration:none}
.logo em{color:var(--orange);font-style:italic}
.nav-pills{display:flex;gap:.3rem;flex-wrap:wrap}
.npill{font-family:'Syne',sans-serif;font-size:.6rem;font-weight:700;letter-spacing:.1em;text-transform:uppercase;padding:.38rem .9rem;border-radius:20px;border:1.5px solid var(--bd);color:var(--i60);text-decoration:none;cursor:pointer;transition:all .2s;background:none}
.npill:hover,.npill.active{background:var(--orange);color:#fff;border-color:var(--orange)}
.npill.schools{border-color:var(--green);color:var(--green)}
.npill.schools:hover,.npill.schools.active{background:var(--green);color:#fff}

/* WORLD SYSTEM */
.world{display:none;min-height:100vh;animation:fadeIn .5s ease}
.world.active{display:block}
@keyframes fadeIn{from{opacity:0;transform:translateY(12px)}to{opacity:1;transform:none}}

/* SHARED */
.ctr{max-width:1280px;margin:0 auto;padding:0 2rem}
.sec{padding:5rem 0}
.sec-lbl{font-family:'JetBrains Mono',monospace;font-size:.55rem;letter-spacing:.28em;text-transform:uppercase;color:var(--i35);margin-bottom:.7rem;display:flex;align-items:center;gap:.6rem}
.sec-lbl::before{content:'';width:24px;height:1px;background:var(--orange)}
.sec-title{font-family:'Cormorant Garamond',serif;font-size:clamp(2rem,4vw,3.2rem);font-weight:700;color:var(--ink);line-height:1;letter-spacing:-.02em;margin-bottom:.5rem}
.sec-title em{font-style:italic;color:var(--orange)}
.sec-sub{font-size:.92rem;color:var(--i60);line-height:1.85;max-width:540px;font-weight:300;margin-bottom:2rem}
.btn{display:inline-flex;align-items:center;gap:.5rem;font-family:'Syne',sans-serif;font-size:.62rem;font-weight:700;letter-spacing:.1em;text-transform:uppercase;padding:.65rem 1.4rem;background:var(--orange);color:#fff;border:none;border-radius:2px;cursor:pointer;transition:all .2s;text-decoration:none}
.btn:hover{background:var(--ora-l);transform:translateY(-2px)}
.btn-out{background:transparent;color:var(--ink);border:1.5px solid var(--bd)}
.btn-out:hover{border-color:var(--orange);color:var(--orange);transform:translateY(-2px)}
.btn-grn{background:var(--green)}.btn-grn:hover{background:#27ae60}
.btn-blu{background:var(--blue)}.btn-blu:hover{background:var(--blu-l)}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   HOME WORLD
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#home-world{background:var(--white)}
.home-hero{min-height:80vh;display:grid;grid-template-columns:1fr 1fr;background:var(--ink2);overflow:hidden;position:relative}
.home-hero-l{padding:6rem 3.5rem 5rem;display:flex;flex-direction:column;justify-content:center;position:relative;z-index:2}
.home-hero-tag{font-family:'JetBrains Mono',monospace;font-size:.55rem;letter-spacing:.22em;text-transform:uppercase;color:var(--ora-xl);margin-bottom:1.2rem}
.home-hero h1{font-family:'Cormorant Garamond',serif;font-size:clamp(3rem,5vw,5.2rem);font-weight:300;line-height:.92;color:#fff;margin-bottom:1.2rem}
.home-hero h1 strong{font-weight:700;display:block}
.home-hero h1 em{font-style:italic;color:var(--ora-xl)}
.home-hero-sub{font-size:.93rem;color:rgba(255,255,255,.5);line-height:1.85;max-width:400px;margin-bottom:2rem;font-weight:300}
.worlds-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:1px;background:rgba(255,255,255,.08);margin-top:3rem}
.world-card{background:var(--ink2);padding:2rem 1.6rem;cursor:pointer;transition:background .2s,transform .2s;position:relative;overflow:hidden}
.world-card::after{content:'';position:absolute;bottom:0;left:0;right:0;height:3px;background:linear-gradient(90deg,var(--orange),var(--ora-xl));transform:scaleX(0);transform-origin:left;transition:transform .35s}
.world-card:hover{background:var(--ink)}.world-card:hover::after{transform:scaleX(1)}
.wc-icon{font-size:2rem;margin-bottom:.8rem}
.wc-name{font-family:'Syne',sans-serif;font-size:.85rem;font-weight:700;color:#fff;margin-bottom:.4rem}
.wc-sub{font-size:.78rem;color:rgba(255,255,255,.35);line-height:1.6}
.wc-tag{font-family:'JetBrains Mono',monospace;font-size:.48rem;letter-spacing:.08em;text-transform:uppercase;color:var(--ora-xl);margin-top:.6rem}
.home-hero-r{background:linear-gradient(160deg,#0a1628,#1A507A,#0d2035);position:relative;overflow:hidden;display:flex;align-items:center;justify-content:center}
.hero-r-content{position:relative;z-index:2;text-align:center;padding:3rem}
.hero-r-quote{font-family:'Cormorant Garamond',serif;font-size:1.8rem;font-style:italic;color:rgba(255,255,255,.85);line-height:1.4;margin-bottom:1.5rem}
.hero-r-attr{font-family:'JetBrains Mono',monospace;font-size:.55rem;letter-spacing:.12em;color:var(--ora-xl)}
.firefly{position:absolute;width:3px;height:3px;border-radius:50%;background:#FFD700;animation:ff linear infinite}
@keyframes ff{0%{opacity:0;transform:translate(0,0)}20%{opacity:1}80%{opacity:.6}100%{opacity:0;transform:translate(var(--tx),var(--ty))}}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   GAMES WORLD â€” SAVANNAH
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#games-world{background:#1a0a00}
.savannah-hero{position:relative;height:340px;overflow:hidden;display:flex;align-items:flex-end;justify-content:center}
.savannah-sky{position:absolute;inset:0;background:linear-gradient(180deg,#0d1b2a 0%,#1a2744 20%,#8B2500 55%,#FF6B35 75%,#FFD700 90%,#FFA500 100%)}
.savannah-sun{position:absolute;bottom:80px;left:50%;transform:translateX(-50%);width:80px;height:80px;border-radius:50%;background:radial-gradient(circle,#FFD700,#FF8C00 50%,transparent 70%);box-shadow:0 0 60px 30px rgba(255,165,0,.4),0 0 120px 60px rgba(255,100,0,.2);animation:sunpulse 4s ease-in-out infinite}
@keyframes sunpulse{0%,100%{box-shadow:0 0 60px 30px rgba(255,165,0,.4),0 0 120px 60px rgba(255,100,0,.2)}50%{box-shadow:0 0 80px 40px rgba(255,165,0,.5),0 0 150px 80px rgba(255,100,0,.25)}}
.savannah-ground{position:absolute;bottom:0;left:0;right:0;height:100px;background:linear-gradient(180deg,#3d1c00,#2a1200)}
.acacia{position:absolute;bottom:70px}
.acacia svg{display:block}
.savannah-title{position:relative;z-index:2;text-align:center;padding-bottom:2rem}
.savannah-title h2{font-family:'Cormorant Garamond',serif;font-size:clamp(2.5rem,5vw,4rem);font-weight:700;color:#FFD700;text-shadow:0 2px 20px rgba(0,0,0,.8);letter-spacing:-.02em}
.savannah-title p{font-family:'JetBrains Mono',monospace;font-size:.55rem;letter-spacing:.2em;text-transform:uppercase;color:rgba(255,215,0,.6);margin-top:.4rem}

.games-body{background:#f5efe6;padding:3rem 0}
.ndebele-border{height:12px;background:repeating-linear-gradient(90deg,#C0392B 0,#C0392B 10%,#E6B32A 10%,#E6B32A 20%,#1B2A3A 20%,#1B2A3A 30%,#1E8449 30%,#1E8449 40%,#fff 40%,#fff 50%,#CA5C08 50%,#CA5C08 60%,#2E8FCC 60%,#2E8FCC 70%,#C0392B 70%,#C0392B 80%,#E6B32A 80%,#E6B32A 90%,#1B2A3A 90%,#1B2A3A 100%)}
.games-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:1.5rem;margin-top:2.5rem}
.game-tile{background:#fff;border-radius:8px;overflow:hidden;box-shadow:0 4px 24px rgba(139,69,19,.12);cursor:pointer;transition:transform .25s,box-shadow .25s;border:2px solid transparent}
.game-tile:hover{transform:translateY(-4px);box-shadow:0 12px 40px rgba(139,69,19,.2);border-color:var(--orange)}
.game-tile-hero{height:160px;display:flex;align-items:center;justify-content:center;position:relative;overflow:hidden}
.gt-mancala{background:linear-gradient(135deg,#3d1c00,#6B3A1F,#8B5E3C)}
.gt-diketo{background:linear-gradient(135deg,#0d2035,#1A507A,#2E8FCC)}
.gt-kgati{background:linear-gradient(135deg,#1B3A1B,#1E8449,#27AE60)}
.gt-ncuva{background:linear-gradient(135deg,#2C1654,#7B2D8B,#9B59B6)}
.game-tile-body{padding:1.4rem}
.gt-tag{font-family:'JetBrains Mono',monospace;font-size:.49rem;letter-spacing:.1em;text-transform:uppercase;padding:.2rem .6rem;border-radius:2px;background:rgba(202,92,8,.1);color:var(--orange);border:1px solid rgba(202,92,8,.2);width:fit-content;margin-bottom:.6rem}
.gt-name{font-family:'Cormorant Garamond',serif;font-size:1.3rem;font-weight:700;color:var(--ink);margin-bottom:.3rem}
.gt-origin{font-family:'JetBrains Mono',monospace;font-size:.52rem;letter-spacing:.06em;color:var(--i35);margin-bottom:.5rem}
.gt-desc{font-size:.82rem;color:var(--i60);line-height:1.65}
.gt-stats{display:flex;gap:1rem;margin-top:.9rem;padding-top:.9rem;border-top:1px solid var(--bd)}
.gt-stat{font-family:'JetBrains Mono',monospace;font-size:.51rem;letter-spacing:.04em;color:var(--i35)}
.gt-stat strong{color:var(--orange);font-size:.72rem}

/* GAME OVERLAY */
.game-overlay{display:none;position:fixed;inset:0;z-index:800;background:rgba(0,0,0,.92);align-items:center;justify-content:center;padding:1rem}
.game-overlay.open{display:flex}
.game-modal{background:#1a0a00;border-radius:8px;width:100%;max-width:700px;max-height:90vh;overflow-y:auto;border:2px solid var(--orange)}
.gm-header{background:linear-gradient(135deg,#3d1c00,#6B3A1F);padding:1.2rem 1.5rem;display:flex;justify-content:space-between;align-items:center;border-bottom:2px solid var(--orange)}
.gm-title{font-family:'Cormorant Garamond',serif;font-size:1.4rem;font-weight:700;color:#FFD700}
.gm-close{background:none;border:none;color:rgba(255,255,255,.5);font-size:1.4rem;cursor:pointer;padding:.2rem .5rem;line-height:1;transition:color .2s}
.gm-close:hover{color:#fff}
.gm-body{padding:1.5rem}
.gm-score-bar{display:flex;justify-content:space-between;align-items:center;background:rgba(255,255,255,.05);border-radius:4px;padding:.8rem 1.2rem;margin-bottom:1.2rem;border:1px solid rgba(255,255,255,.08)}
.gm-score-item{text-align:center}
.gm-score-item span{display:block;font-family:'JetBrains Mono',monospace;font-size:.5rem;letter-spacing:.1em;text-transform:uppercase;color:rgba(255,255,255,.35)}
.gm-score-item strong{font-family:'Cormorant Garamond',serif;font-size:1.6rem;font-weight:700;color:var(--ora-xl)}

/* MANCALA GAME */
#mancala-game{color:#fff}
.mancala-board{background:linear-gradient(135deg,#2a1200,#4a2000);border-radius:12px;padding:1.5rem;border:3px solid #8B5E3C;box-shadow:inset 0 0 30px rgba(0,0,0,.5)}
.mancala-row{display:flex;align-items:center;gap:.5rem;margin:.4rem 0}
.mancala-store{width:60px;height:120px;border-radius:30px;background:linear-gradient(180deg,#5a3000,#3a1a00);border:2px solid #8B5E3C;display:flex;align-items:center;justify-content:center;flex-direction:column;gap:.2rem}
.mancala-store strong{font-family:'Cormorant Garamond',serif;font-size:1.8rem;font-weight:700;color:#FFD700}
.mancala-store span{font-family:'JetBrains Mono',monospace;font-size:.42rem;letter-spacing:.05em;color:rgba(255,255,255,.4)}
.mancala-pits{display:flex;gap:.5rem;flex:1;justify-content:center}
.mancala-pit{width:52px;height:52px;border-radius:50%;background:linear-gradient(135deg,#5a3000,#3a1a00);border:2px solid #8B5E3C;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .2s;position:relative;font-family:'Cormorant Garamond',serif;font-size:1.3rem;font-weight:700;color:#FFD700}
.mancala-pit:hover{background:linear-gradient(135deg,#7a4500,#5a2500);transform:scale(1.08);border-color:var(--orange)}
.mancala-pit.disabled{cursor:default;opacity:.5}
.mancala-pit.active{border-color:#FFD700;box-shadow:0 0 12px rgba(255,215,0,.4)}
.mancala-seeds{display:flex;flex-wrap:wrap;gap:2px;justify-content:center;align-items:center;width:36px}
.seed{width:6px;height:6px;border-radius:50%;background:#8B5E3C}
.seed.p1{background:#E6B32A}
.seed.p2{background:#2E8FCC}
.mancala-label{font-family:'JetBrains Mono',monospace;font-size:.48rem;letter-spacing:.07em;text-transform:uppercase;color:rgba(255,255,255,.35);text-align:center;margin:.3rem 0}
.game-msg{font-family:'Cormorant Garamond',serif;font-size:1rem;font-style:italic;color:var(--ora-xl);text-align:center;margin:1rem 0;min-height:1.5rem}

/* DIKETO GAME */
#diketo-game{color:#fff}
.diketo-area{text-align:center;padding:1rem}
.diketo-stone-display{font-size:5rem;margin:1rem 0;animation:stoneBounce .3s ease;display:block}
@keyframes stoneBounce{0%,100%{transform:scale(1)}50%{transform:scale(1.3)}}
.diketo-sequence{display:flex;gap:.5rem;justify-content:center;margin:1rem 0;flex-wrap:wrap}
.dseq-item{width:44px;height:44px;border-radius:50%;border:2px solid rgba(255,255,255,.2);display:flex;align-items:center;justify-content:center;font-size:1.2rem;transition:all .3s}
.dseq-item.active{border-color:#FFD700;background:rgba(255,215,0,.15);transform:scale(1.2)}
.dseq-item.correct{border-color:#27AE60;background:rgba(39,174,96,.15)}
.dseq-item.wrong{border-color:#E74C3C;background:rgba(231,76,60,.15)}
.diketo-tap-btn{width:120px;height:120px;border-radius:50%;background:linear-gradient(135deg,var(--orange),var(--ora-l));border:4px solid #FFD700;cursor:pointer;font-family:'Syne',sans-serif;font-size:.7rem;font-weight:700;letter-spacing:.1em;color:#fff;transition:all .15s;margin:1rem auto;display:block;box-shadow:0 0 20px rgba(255,165,0,.3)}
.diketo-tap-btn:active{transform:scale(.93);box-shadow:0 0 8px rgba(255,165,0,.2)}

/* KGATI GAME */
#kgati-game{color:#fff;text-align:center}
.kgati-rope-area{position:relative;height:180px;margin:1rem 0;overflow:hidden}
.kgati-rope{position:absolute;left:0;right:0;top:50%;height:4px;background:linear-gradient(90deg,#8B5E3C,#FFD700,#8B5E3C);transform-origin:center;animation:ropeSwing 1s ease-in-out infinite;border-radius:2px}
@keyframes ropeSwing{0%,100%{transform:scaleY(1) rotate(-5deg) translateY(-50%)}50%{transform:scaleY(2) rotate(5deg) translateY(-50%)}}
.kgati-jumper{position:absolute;bottom:20px;left:50%;transform:translateX(-50%);font-size:2.5rem;transition:bottom .2s}
.kgati-jumper.jump{bottom:100px}
.kgati-pattern{display:flex;gap:.6rem;justify-content:center;margin:1rem 0;flex-wrap:wrap}
.kp-item{padding:.4rem .9rem;border-radius:4px;border:2px solid rgba(255,255,255,.15);font-family:'Syne',sans-serif;font-size:.65rem;font-weight:700;letter-spacing:.08em;color:rgba(255,255,255,.6);cursor:pointer;transition:all .2s}
.kp-item:hover,.kp-item.sel{border-color:#FFD700;background:rgba(255,215,0,.1);color:#FFD700}

/* NCUVA GAME */
#ncuva-game{color:#fff;text-align:center}
.ncuva-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:.5rem;margin:1rem auto;max-width:280px}
.ncuva-cell{aspect-ratio:1;border-radius:6px;background:rgba(255,255,255,.05);border:2px solid rgba(255,255,255,.1);cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:1.4rem;transition:all .3s}
.ncuva-cell:hover{border-color:rgba(255,255,255,.3)}
.ncuva-cell.lit{border-color:#FFD700;background:rgba(255,215,0,.2);box-shadow:0 0 10px rgba(255,215,0,.3)}
.ncuva-cell.selected{border-color:var(--orange);background:rgba(202,92,8,.2)}
.ncuva-cell.correct{border-color:#27AE60;background:rgba(39,174,96,.2)}
.ncuva-cell.wrong{border-color:#E74C3C;background:rgba(231,76,60,.2)}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   INSTRUMENTS WORLD
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#instruments-world{background:#0d1117}
.inst-hero{background:linear-gradient(160deg,#0d1117,#1a2744,#0d2a1a);padding:5rem 0 3rem;text-align:center;position:relative;overflow:hidden}
.inst-hero::before{content:'';position:absolute;inset:0;background:radial-gradient(ellipse at 30% 50%,rgba(202,92,8,.08),transparent 60%),radial-gradient(ellipse at 70% 30%,rgba(26,110,168,.08),transparent 60%)}
.inst-hero h2{font-family:'Cormorant Garamond',serif;font-size:clamp(2.5rem,5vw,4rem);font-weight:700;color:#fff;letter-spacing:-.02em}
.inst-hero h2 em{font-style:italic;color:var(--ora-xl)}
.inst-hero p{font-family:'DM Sans',sans-serif;font-size:.92rem;color:rgba(255,255,255,.45);max-width:500px;margin:.8rem auto 0;line-height:1.85}

.studio{display:grid;grid-template-columns:1fr 320px;gap:2rem;align-items:start;padding:3rem 0}
.inst-selector{display:grid;grid-template-columns:repeat(2,1fr);gap:1rem;margin-bottom:2rem}
.inst-btn{background:rgba(255,255,255,.04);border:2px solid rgba(255,255,255,.08);border-radius:8px;padding:1.2rem;cursor:pointer;transition:all .25s;text-align:center}
.inst-btn:hover,.inst-btn.active{border-color:var(--orange);background:rgba(202,92,8,.08)}
.inst-btn .inst-emoji{font-size:2.2rem;display:block;margin-bottom:.5rem}
.inst-btn .inst-name{font-family:'Syne',sans-serif;font-size:.7rem;font-weight:700;color:#fff;letter-spacing:.08em;text-transform:uppercase}
.inst-btn .inst-origin{font-family:'JetBrains Mono',monospace;font-size:.5rem;letter-spacing:.06em;color:rgba(255,255,255,.3);margin-top:.2rem}

.inst-play-area{background:rgba(255,255,255,.03);border:1px solid rgba(255,255,255,.08);border-radius:12px;padding:1.8rem;min-height:300px}
.inst-title-bar{display:flex;align-items:center;gap:1rem;margin-bottom:.4rem}
.inst-play-title{font-family:'Cormorant Garamond',serif;font-size:1.5rem;font-weight:700;color:#fff}
.inst-play-sub{font-size:.8rem;color:rgba(255,255,255,.35);margin-bottom:1.5rem;line-height:1.6}

/* DJEMBE */
.djembe-pads{display:grid;grid-template-columns:repeat(4,1fr);gap:.6rem}
.drum-pad{aspect-ratio:1;border-radius:50%;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:.6rem;font-family:'Syne',sans-serif;font-weight:700;letter-spacing:.06em;color:#fff;border:3px solid transparent;transition:all .12s;user-select:none;text-transform:uppercase}
.drum-pad:active,.drum-pad.hit{transform:scale(.92);filter:brightness(1.3)}
.dp1{background:linear-gradient(135deg,#5D1A00,#8B2500)}
.dp2{background:linear-gradient(135deg,#1A3A5D,#1A6EA8)}
.dp3{background:linear-gradient(135deg,#1A3D1A,#1E8449)}
.dp4{background:linear-gradient(135deg,#4D2A00,#7A4500)}
.dp5{background:linear-gradient(135deg,#3D0A2A,#8B1A4A)}
.dp6{background:linear-gradient(135deg,#2A1A00,#5A3A00)}
.dp7{background:linear-gradient(135deg,#001A3D,#003D8A)}
.dp8{background:linear-gradient(135deg,#1A001A,#5A0A5A)}

/* MBIRA */
.mbira-keys{display:flex;gap:4px;align-items:flex-end;justify-content:center;height:180px;padding:1rem 0}
.mbira-key{flex:1;max-width:36px;border-radius:4px 4px 8px 8px;cursor:pointer;transition:all .12s;position:relative;border:2px solid rgba(255,255,255,.1)}
.mbira-key:hover,.mbira-key:active,.mbira-key.hit{filter:brightness(1.5);transform:scaleY(.95);transform-origin:top}
.mkey-label{position:absolute;bottom:4px;left:50%;transform:translateX(-50%);font-family:'JetBrains Mono',monospace;font-size:.4rem;color:rgba(255,255,255,.5);white-space:nowrap}

/* HOSHO */
.hosho-area{display:flex;flex-direction:column;align-items:center;gap:1.5rem;padding:1rem}
.hosho-gourd{width:120px;height:140px;border-radius:50% 50% 40% 40%;background:radial-gradient(circle at 35% 30%,#D4A056,#8B6914,#5A4008);border:3px solid #6B4F12;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:3rem;transition:all .15s;box-shadow:0 8px 24px rgba(0,0,0,.4)}
.hosho-gourd:active,.hosho-gourd.shake{animation:hoshoShake .15s ease;filter:brightness(1.2)}
@keyframes hoshoShake{0%,100%{transform:rotate(0)}25%{transform:rotate(-15deg)}75%{transform:rotate(15deg)}}
.hosho-patterns{display:grid;grid-template-columns:repeat(4,1fr);gap:.5rem;width:100%}
.hosho-btn{padding:.6rem;border-radius:4px;background:rgba(255,255,255,.04);border:1.5px solid rgba(255,255,255,.08);cursor:pointer;font-family:'JetBrains Mono',monospace;font-size:.48rem;letter-spacing:.06em;color:rgba(255,255,255,.5);transition:all .2s;text-align:center}
.hosho-btn:hover,.hosho-btn.active{border-color:var(--gold);color:var(--gold);background:rgba(230,179,42,.08)}

/* UHADI */
.uhadi-strings{display:flex;gap:2rem;justify-content:center;align-items:stretch;height:200px;padding:1rem}
.uhadi-string{display:flex;flex-direction:column;align-items:center;gap:.5rem;cursor:pointer}
.uhadi-stick{width:6px;flex:1;border-radius:3px;transition:all .15s;position:relative}
.uhadi-stick::after{content:'';position:absolute;inset:0;border-radius:3px;background:inherit;filter:blur(4px);opacity:.6}
.uhadi-stick:hover,.uhadi-stick.pluck{animation:pluck .3s ease;filter:brightness(1.5)}
@keyframes pluck{0%,100%{transform:scaleX(1)}50%{transform:scaleX(1.8)}}
.uhadi-label{font-family:'JetBrains Mono',monospace;font-size:.5rem;letter-spacing:.05em;color:rgba(255,255,255,.4)}

/* RECORDER */
.recorder-panel{background:rgba(0,0,0,.4);border:1px solid rgba(255,255,255,.08);border-radius:12px;padding:1.5rem;position:sticky;top:80px}
.rec-title{font-family:'Syne',sans-serif;font-size:.7rem;font-weight:700;letter-spacing:.1em;text-transform:uppercase;color:#fff;margin-bottom:1rem}
.rec-btn-main{width:64px;height:64px;border-radius:50%;background:var(--red);border:4px solid rgba(255,255,255,.2);cursor:pointer;margin:0 auto 1rem;display:block;position:relative;transition:all .2s}
.rec-btn-main::after{content:'';position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:20px;height:20px;border-radius:50%;background:#fff}
.rec-btn-main.recording{animation:recPulse 1s ease-in-out infinite;border-color:rgba(255,0,0,.5)}
@keyframes recPulse{0%,100%{box-shadow:0 0 0 0 rgba(255,0,0,.4)}50%{box-shadow:0 0 0 12px rgba(255,0,0,0)}}
.rec-btn-main.recording::after{border-radius:3px;width:16px;height:16px}
.rec-status{font-family:'JetBrains Mono',monospace;font-size:.52rem;letter-spacing:.1em;text-transform:uppercase;color:rgba(255,255,255,.3);text-align:center;margin-bottom:1rem}
.rec-timeline{height:40px;background:rgba(255,255,255,.04);border-radius:4px;margin-bottom:1rem;overflow:hidden;position:relative;border:1px solid rgba(255,255,255,.06)}
.rec-wave{height:100%;display:flex;align-items:center;gap:2px;padding:0 4px}
.rec-bar{width:3px;border-radius:2px;background:var(--orange);transition:height .1s}
.rec-controls{display:flex;gap:.5rem}
.rec-ctrl{flex:1;padding:.5rem;background:rgba(255,255,255,.04);border:1px solid rgba(255,255,255,.08);border-radius:4px;cursor:pointer;font-family:'JetBrains Mono',monospace;font-size:.48rem;letter-spacing:.06em;text-transform:uppercase;color:rgba(255,255,255,.4);transition:all .2s;text-align:center}
.rec-ctrl:hover{border-color:rgba(255,255,255,.2);color:#fff}
.rec-ctrl.active{border-color:var(--orange);color:var(--orange)}
.post-wall-btn{width:100%;margin-top:.8rem;padding:.7rem;background:linear-gradient(135deg,var(--orange),var(--ora-l));border:none;border-radius:4px;cursor:pointer;font-family:'Syne',sans-serif;font-size:.6rem;font-weight:700;letter-spacing:.1em;text-transform:uppercase;color:#fff;transition:opacity .2s}
.post-wall-btn:hover{opacity:.85}
.posted-notif{font-family:'JetBrains Mono',monospace;font-size:.5rem;letter-spacing:.06em;color:#27AE60;text-align:center;margin-top:.5rem;display:none}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   BRAIN TEASERS WORLD
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#brain-world{background:#F8F4EE}
.brain-hero{background:linear-gradient(135deg,var(--ink2),#1a3a5d);padding:5rem 0 3rem;position:relative;overflow:hidden;text-align:center}
.brain-hero::before{content:'';position:absolute;inset:0;opacity:.05;background-image:repeating-linear-gradient(45deg,transparent,transparent 20px,#E6B32A 20px,#E6B32A 21px),repeating-linear-gradient(-45deg,transparent,transparent 20px,#CA5C08 20px,#CA5C08 21px)}
.brain-hero h2{font-family:'Cormorant Garamond',serif;font-size:clamp(2.5rem,5vw,4rem);font-weight:700;color:#fff;position:relative;z-index:2}
.brain-hero h2 em{color:var(--ora-xl);font-style:italic}
.brain-hero p{font-size:.9rem;color:rgba(255,255,255,.45);max-width:460px;margin:.8rem auto 0;line-height:1.85;position:relative;z-index:2}
.streak-bar{background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.1);border-radius:8px;padding:1rem 1.5rem;display:flex;align-items:center;gap:1.5rem;max-width:500px;margin:2rem auto 0;position:relative;z-index:2}
.streak-fire{font-size:2rem}
.streak-info strong{font-family:'Cormorant Garamond',serif;font-size:1.8rem;font-weight:700;color:#FFD700;display:block;line-height:1}
.streak-info span{font-family:'JetBrains Mono',monospace;font-size:.5rem;letter-spacing:.1em;text-transform:uppercase;color:rgba(255,255,255,.35)}
.streak-dots{display:flex;gap:.4rem;margin-left:auto}
.sd{width:10px;height:10px;border-radius:50%;background:rgba(255,255,255,.15);border:1.5px solid rgba(255,255,255,.15)}
.sd.done{background:#FFD700;border-color:#FFD700}
.sd.today{background:var(--orange);border-color:var(--orange);box-shadow:0 0 6px rgba(202,92,8,.5)}

.puzzle-tabs{display:flex;gap:.5rem;flex-wrap:wrap;margin:2.5rem 0 2rem}
.ptab{font-family:'Syne',sans-serif;font-size:.6rem;font-weight:700;letter-spacing:.08em;text-transform:uppercase;padding:.5rem 1.1rem;border-radius:20px;border:1.5px solid var(--bd);color:var(--i60);cursor:pointer;transition:all .2s;background:#fff}
.ptab:hover,.ptab.active{background:var(--ink2);color:#fff;border-color:var(--ink2)}

.puzzle-stage{background:#fff;border-radius:12px;padding:2.5rem;box-shadow:0 4px 24px rgba(27,42,58,.08);min-height:320px;border:1px solid var(--bd)}
.puzzle-q{font-family:'Cormorant Garamond',serif;font-size:1.5rem;font-weight:300;color:var(--ink);line-height:1.4;margin-bottom:1.5rem}
.puzzle-q strong{font-weight:700;color:var(--orange)}
.puzzle-options{display:grid;grid-template-columns:1fr 1fr;gap:.7rem;margin-bottom:1.2rem}
.p-opt{padding:.9rem 1.2rem;border-radius:6px;border:2px solid var(--bd);background:#fff;cursor:pointer;font-size:.88rem;color:var(--ink);transition:all .2s;text-align:left;font-family:'DM Sans',sans-serif;line-height:1.4}
.p-opt:hover{border-color:var(--orange);background:rgba(202,92,8,.03)}
.p-opt.correct{border-color:#27AE60;background:rgba(39,174,96,.08);color:#1a6b3a}
.p-opt.wrong{border-color:#E74C3C;background:rgba(231,76,60,.06);color:#8B0000}
.p-opt.disabled{cursor:default}
.puzzle-fill{width:100%;padding:.9rem 1.2rem;font-size:1rem;font-family:'DM Sans',sans-serif;border:2px solid var(--bd);border-radius:6px;outline:none;color:var(--ink);margin-bottom:.8rem;transition:border-color .2s}
.puzzle-fill:focus{border-color:var(--orange)}
.puzzle-result{padding:1rem 1.4rem;border-radius:6px;font-family:'Cormorant Garamond',serif;font-size:1.1rem;font-style:italic;margin:1rem 0;display:none}
.puzzle-result.correct{background:rgba(39,174,96,.08);border:1px solid rgba(39,174,96,.2);color:#1a6b3a}
.puzzle-result.wrong{background:rgba(231,76,60,.06);border:1px solid rgba(231,76,60,.2);color:#8B0000}
.pattern-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:.8rem;margin:1rem 0}
.pattern-cell{aspect-ratio:1;border-radius:6px;border:2px solid var(--bd);display:flex;align-items:center;justify-content:center;font-size:1.6rem;cursor:pointer;transition:all .2s;background:#fff}
.pattern-cell:hover{border-color:var(--orange);transform:scale(1.05)}
.pattern-cell.correct{border-color:#27AE60;background:rgba(39,174,96,.08)}
.pattern-cell.wrong{border-color:#E74C3C}
.puzzle-nav{display:flex;justify-content:space-between;align-items:center;margin-top:1.5rem;padding-top:1.5rem;border-top:1px solid var(--bd)}
.puzzle-points{font-family:'JetBrains Mono',monospace;font-size:.55rem;letter-spacing:.1em;color:var(--orange);display:flex;align-items:center;gap:.4rem}
.puzzle-points::before{content:'â˜…';font-size:.7rem}
.maths-scenario{background:linear-gradient(135deg,rgba(26,110,168,.06),rgba(30,132,73,.04));border:1px solid rgba(26,110,168,.15);border-radius:8px;padding:1.2rem;margin-bottom:1.2rem;border-left:3px solid var(--blue)}
.maths-scenario .ms-lbl{font-family:'JetBrains Mono',monospace;font-size:.5rem;letter-spacing:.12em;text-transform:uppercase;color:var(--blue);margin-bottom:.5rem}
.maths-scenario .ms-story{font-size:.9rem;color:var(--i60);line-height:1.75;font-style:italic}
.drum-sequence{display:flex;gap:.6rem;justify-content:center;margin:1rem 0;flex-wrap:wrap}
.drum-beat{width:40px;height:40px;border-radius:8px;border:2px solid rgba(27,42,58,.12);display:flex;align-items:center;justify-content:center;font-size:1.2rem;transition:all .3s}
.drum-beat.active{border-color:var(--orange);background:rgba(202,92,8,.1);transform:scale(1.2)}
.drum-beat.user-tap{border-color:var(--blue);background:rgba(26,110,168,.1)}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ANCESTOR TREE WORLD
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#tree-world{background:#020d1a}
.tree-canvas-wrap{position:relative;height:100vh;min-height:600px;display:flex;flex-direction:column;align-items:center;justify-content:center;overflow:hidden}
#tree-canvas{position:absolute;inset:0;width:100%;height:100%}
.tree-ui{position:relative;z-index:2;text-align:center;pointer-events:none}
.tree-ui h2{font-family:'Cormorant Garamond',serif;font-size:clamp(1.8rem,4vw,3rem);font-weight:700;color:#fff;text-shadow:0 0 40px rgba(100,181,232,.4);margin-bottom:.5rem}
.tree-ui h2 em{font-style:italic;color:#64B5E8}
.tree-ui p{font-size:.85rem;color:rgba(255,255,255,.4);line-height:1.85;max-width:380px;margin:0 auto 1.5rem}
.tree-tooltip{background:rgba(2,13,26,.85);border:1px solid rgba(100,181,232,.2);border-radius:6px;padding:.7rem 1rem;font-size:.78rem;color:rgba(255,255,255,.6);max-width:280px;margin:.8rem auto;line-height:1.6;pointer-events:none;backdrop-filter:blur(8px)}
.tree-actions{pointer-events:all;display:flex;gap:.8rem;justify-content:center;flex-wrap:wrap;margin-top:1rem}
.tree-stat-bar{position:absolute;bottom:2rem;left:50%;transform:translateX(-50%);z-index:2;display:flex;gap:2rem;background:rgba(2,13,26,.75);border:1px solid rgba(100,181,232,.15);border-radius:8px;padding:.9rem 2rem;backdrop-filter:blur(8px)}
.ts-item{text-align:center}
.ts-item strong{font-family:'Cormorant Garamond',serif;font-size:1.8rem;font-weight:700;color:#64B5E8;display:block;line-height:1}
.ts-item span{font-family:'JetBrains Mono',monospace;font-size:.45rem;letter-spacing:.1em;text-transform:uppercase;color:rgba(255,255,255,.3)}
.leaf-popup{position:absolute;background:rgba(2,13,26,.92);border:1px solid rgba(100,181,232,.25);border-radius:6px;padding:.6rem .9rem;font-size:.75rem;color:#fff;pointer-events:none;z-index:3;display:none;max-width:160px;line-height:1.4;backdrop-filter:blur(8px)}
.leaf-popup strong{color:#64B5E8;display:block}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SCHOOLS WORLD
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#schools-world{background:#F0F7F0}
.schools-hero{background:linear-gradient(135deg,#0d2a1a,#1E8449,#145A32);padding:5rem 0 3rem;position:relative;overflow:hidden;text-align:center}
.schools-hero::before{content:'';position:absolute;inset:0;opacity:.06;background-image:repeating-linear-gradient(0deg,transparent,transparent 29px,rgba(255,255,255,.8) 29px,rgba(255,255,255,.8) 30px),repeating-linear-gradient(90deg,transparent,transparent 29px,rgba(255,255,255,.8) 29px,rgba(255,255,255,.8) 30px);background-size:30px 30px}
.schools-hero h2{font-family:'Cormorant Garamond',serif;font-size:clamp(2.4rem,5vw,4rem);font-weight:700;color:#fff;position:relative;z-index:2}
.schools-hero h2 em{color:#86EFAC;font-style:italic}
.schools-hero p{font-size:.9rem;color:rgba(255,255,255,.5);max-width:500px;margin:.8rem auto 1.5rem;line-height:1.85;position:relative;z-index:2}
.grade-pills{display:flex;gap:.5rem;justify-content:center;flex-wrap:wrap;position:relative;z-index:2}
.grade-pill{font-family:'Syne',sans-serif;font-size:.62rem;font-weight:700;letter-spacing:.08em;padding:.4rem 1rem;border-radius:20px;border:2px solid rgba(255,255,255,.2);color:rgba(255,255,255,.5);cursor:pointer;transition:all .2s;background:none}
.grade-pill:hover,.grade-pill.active{background:#fff;color:var(--green);border-color:#fff}
.grade-pill.priority{border-color:#86EFAC;color:#86EFAC}
.grade-pill.priority:hover,.grade-pill.priority.active{background:#86EFAC;color:#145A32}

.subjects-nav{display:flex;gap:.5rem;flex-wrap:wrap;margin:2.5rem 0 1.5rem}
.sub-tab{display:flex;align-items:center;gap:.5rem;font-family:'Syne',sans-serif;font-size:.6rem;font-weight:700;letter-spacing:.08em;text-transform:uppercase;padding:.5rem 1.1rem;border-radius:6px;border:2px solid var(--bd);color:var(--i60);cursor:pointer;transition:all .2s;background:#fff}
.sub-tab .sub-icon{font-size:.9rem}
.sub-tab:hover{border-color:var(--green);color:var(--green)}
.sub-tab.active{background:var(--green);color:#fff;border-color:var(--green)}
.sub-tab.maths:hover,.sub-tab.maths.active{border-color:var(--blue);background:var(--blue);color:#fff}
.sub-tab.science:hover,.sub-tab.science.active{border-color:#9B59B6;background:#9B59B6;color:#fff}

.topic-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:1rem;margin-bottom:2rem}
.topic-card{background:#fff;border-radius:8px;padding:1.4rem;border:2px solid transparent;cursor:pointer;transition:all .2s;box-shadow:0 2px 12px rgba(30,132,73,.06)}
.topic-card:hover{border-color:var(--green);transform:translateY(-2px);box-shadow:0 8px 24px rgba(30,132,73,.1)}
.topic-card.maths:hover{border-color:var(--blue)}
.topic-card.science:hover{border-color:#9B59B6}
.tc-icon{font-size:1.5rem;margin-bottom:.5rem}
.tc-name{font-family:'Syne',sans-serif;font-size:.78rem;font-weight:700;color:var(--ink);margin-bottom:.3rem}
.tc-sub{font-size:.75rem;color:var(--i60);line-height:1.55}
.tc-badge{font-family:'JetBrains Mono',monospace;font-size:.46rem;letter-spacing:.07em;text-transform:uppercase;padding:.15rem .5rem;border-radius:2px;background:rgba(30,132,73,.08);color:var(--green);border:1px solid rgba(30,132,73,.15);margin-top:.5rem;width:fit-content}
.tc-badge.maths{background:rgba(26,110,168,.08);color:var(--blue);border-color:rgba(26,110,168,.15)}
.tc-badge.science{background:rgba(155,89,182,.08);color:#9B59B6;border-color:rgba(155,89,182,.15)}

/* NOTES PANEL */
.notes-overlay{display:none;position:fixed;inset:0;z-index:800;background:rgba(0,0,0,.7);align-items:center;justify-content:center;padding:1rem}
.notes-overlay.open{display:flex}
.notes-modal{background:#fff;border-radius:8px;width:100%;max-width:720px;max-height:88vh;overflow-y:auto;box-shadow:0 20px 60px rgba(0,0,0,.3)}
.nm-header{background:linear-gradient(135deg,#0d2a1a,#1E8449);padding:1.2rem 1.5rem;display:flex;justify-content:space-between;align-items:center;position:sticky;top:0}
.nm-title{font-family:'Cormorant Garamond',serif;font-size:1.3rem;font-weight:700;color:#fff}
.nm-close{background:none;border:none;color:rgba(255,255,255,.6);font-size:1.4rem;cursor:pointer;padding:.2rem .5rem;line-height:1}
.nm-close:hover{color:#fff}
.nm-body{padding:2rem}
.nm-section{margin-bottom:1.8rem}
.nm-section-title{font-family:'Syne',sans-serif;font-size:.65rem;font-weight:700;letter-spacing:.15em;text-transform:uppercase;color:var(--i35);margin-bottom:.8rem;padding-bottom:.5rem;border-bottom:1px solid var(--bd)}
.nm-section-title.maths{color:var(--blue);border-color:rgba(26,110,168,.2)}
.nm-section-title.science{color:#9B59B6;border-color:rgba(155,89,182,.2)}
.nm-body p{font-size:.9rem;color:var(--i60);line-height:1.9;margin-bottom:.8rem;font-weight:300}
.nm-body strong{color:var(--ink);font-weight:600}
.formula-box{background:linear-gradient(135deg,rgba(26,110,168,.05),rgba(155,89,182,.04));border:1px solid rgba(26,110,168,.15);border-radius:6px;padding:1rem 1.2rem;margin:.8rem 0;border-left:3px solid var(--blue)}
.formula-box .f-lbl{font-family:'JetBrains Mono',monospace;font-size:.5rem;letter-spacing:.1em;text-transform:uppercase;color:var(--blue);margin-bottom:.4rem}
.formula-box .f-eq{font-family:'JetBrains Mono',monospace;font-size:.88rem;color:var(--ink);line-height:1.8}
.tip-box{background:rgba(202,92,8,.05);border:1px solid rgba(202,92,8,.15);border-radius:6px;padding:1rem 1.2rem;margin:.8rem 0;border-left:3px solid var(--orange);display:flex;gap:.8rem}
.tip-box .tip-icon{font-size:1.2rem;flex-shrink:0}
.tip-box .tip-text{font-size:.85rem;color:var(--i60);line-height:1.75;font-style:italic}
.tip-box .tip-lbl{font-family:'JetBrains Mono',monospace;font-size:.48rem;letter-spacing:.1em;text-transform:uppercase;color:var(--orange);margin-bottom:.25rem}
.practice-q{background:var(--paper);border-radius:6px;padding:1rem;margin-bottom:.6rem;border-left:3px solid var(--bd)}
.pq-num{font-family:'JetBrains Mono',monospace;font-size:.5rem;letter-spacing:.08em;color:var(--i35);margin-bottom:.3rem}
.pq-q{font-size:.88rem;color:var(--ink);line-height:1.6;margin-bottom:.5rem}
.pq-toggle{font-family:'JetBrains Mono',monospace;font-size:.5rem;letter-spacing:.06em;text-transform:uppercase;color:var(--orange);cursor:pointer;background:none;border:none;padding:0;transition:color .2s}
.pq-toggle:hover{color:var(--ora-l)}
.pq-ans{font-size:.83rem;color:var(--green);line-height:1.65;margin-top:.5rem;display:none;padding:.5rem;background:rgba(30,132,73,.05);border-radius:4px}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   AUDIO WORLD
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#audio-world{background:#1a0d00}
.audio-hero{background:linear-gradient(160deg,#1a0d00,#3d1c00,#0d1a2a);padding:5rem 0 3rem;text-align:center;position:relative;overflow:hidden}
.audio-hero h2{font-family:'Cormorant Garamond',serif;font-size:clamp(2.5rem,5vw,4rem);font-weight:700;color:#FFD700;position:relative;z-index:2}
.audio-hero h2 em{font-style:italic;color:var(--ora-xl)}
.audio-hero p{font-size:.9rem;color:rgba(255,255,255,.4);max-width:460px;margin:.8rem auto 0;line-height:1.85;position:relative;z-index:2}
.vinyl{position:absolute;right:-40px;top:-40px;width:240px;height:240px;border-radius:50%;background:conic-gradient(#1a0d00,#3d1c00,#1a0d00,#3d1c00,#1a0d00);border:3px solid rgba(255,215,0,.15);opacity:.3;animation:spin 20s linear infinite}
@keyframes spin{from{transform:rotate(0)}to{transform:rotate(360deg)}}
.audio-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:1.2rem;padding:3rem 0}
.audio-card{border-radius:10px;overflow:hidden;cursor:pointer;transition:transform .25s;position:relative}
.audio-card:hover{transform:translateY(-4px)}
.ac-art{height:180px;display:flex;align-items:center;justify-content:center;position:relative}
.ac-art-1{background:linear-gradient(135deg,#5D1A00,#8B2500,#C0392B)}
.ac-art-2{background:linear-gradient(135deg,#0d2a1a,#1E8449,#27AE60)}
.ac-art-3{background:linear-gradient(135deg,#1A0D2E,#7B2D8B,#9B59B6)}
.ac-art-4{background:linear-gradient(135deg,#1a2744,#1A6EA8,#2E8FCC)}
.ac-art-5{background:linear-gradient(135deg,#2a1a00,#8B6914,#E6B32A)}
.ac-art-6{background:linear-gradient(135deg,#0d1117,#1B2A3A,#22344A)}
.ac-vinyl-icon{font-size:3rem;opacity:.6}
.ac-coming{position:absolute;top:.8rem;right:.8rem;font-family:'JetBrains Mono',monospace;font-size:.45rem;letter-spacing:.1em;text-transform:uppercase;padding:.2rem .6rem;border-radius:2px;background:rgba(255,215,0,.15);border:1px solid rgba(255,215,0,.25);color:#FFD700}
.ac-body{background:#2a1200;padding:1.2rem}
.ac-name{font-family:'Cormorant Garamond',serif;font-size:1.1rem;font-weight:700;color:#FFD700;margin-bottom:.25rem}
.ac-desc{font-size:.78rem;color:rgba(255,255,255,.35);line-height:1.6}
.ac-notify{display:flex;align-items:center;gap:.5rem;margin-top:.8rem;font-family:'JetBrains Mono',monospace;font-size:.48rem;letter-spacing:.06em;text-transform:uppercase;color:var(--orange);cursor:pointer;background:none;border:none;padding:0;transition:color .2s}
.ac-notify:hover{color:var(--ora-xl)}
.ac-notify::before{content:'ğŸ””';font-size:.8rem}

/* COMMUNITY WALL */
.community-wall{background:#f5efe6;padding:4rem 0}
.wall-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:1rem;margin-top:2rem}
.wall-post{background:#fff;border-radius:8px;padding:1.2rem;border:1px solid var(--bd);transition:border-color .2s}
.wall-post:hover{border-color:var(--orange)}
.wp-type{font-family:'JetBrains Mono',monospace;font-size:.47rem;letter-spacing:.1em;text-transform:uppercase;padding:.18rem .5rem;border-radius:2px;width:fit-content;margin-bottom:.6rem}
.wp-music{background:rgba(202,92,8,.08);color:var(--orange);border:1px solid rgba(202,92,8,.18)}
.wp-story{background:rgba(26,110,168,.08);color:var(--blue);border:1px solid rgba(26,110,168,.18)}
.wp-achieve{background:rgba(30,132,73,.08);color:var(--green);border:1px solid rgba(30,132,73,.18)}
.wp-name{font-family:'Syne',sans-serif;font-size:.78rem;font-weight:700;color:var(--ink);margin-bottom:.25rem}
.wp-content{font-size:.8rem;color:var(--i60);line-height:1.6}
.wp-meta{font-family:'JetBrains Mono',monospace;font-size:.47rem;letter-spacing:.04em;color:var(--i35);margin-top:.6rem}
.wp-play{display:flex;align-items:center;gap:.4rem;font-family:'Syne',sans-serif;font-size:.56rem;font-weight:700;letter-spacing:.08em;text-transform:uppercase;color:var(--orange);cursor:pointer;background:none;border:none;padding:0;margin-top:.5rem;transition:gap .2s}
.wp-play:hover{gap:.7rem}

/* â• RESPONSIVE â• */
@media(max-width:900px){
  .home-hero{grid-template-columns:1fr}
  .home-hero-r{min-height:280px}
  .worlds-grid{grid-template-columns:repeat(2,1fr)}
  .studio{grid-template-columns:1fr}
  .games-grid{grid-template-columns:1fr}
  .topic-grid{grid-template-columns:repeat(2,1fr)}
  .wall-grid{grid-template-columns:1fr 1fr}
  .audio-grid{grid-template-columns:1fr 1fr}
}
@media(max-width:600px){
  .nav-pills{display:none}
  .worlds-grid{grid-template-columns:1fr 1fr}
  .topic-grid{grid-template-columns:1fr}
  .puzzle-options{grid-template-columns:1fr}
  .wall-grid,.audio-grid{grid-template-columns:1fr}
  .inst-selector{grid-template-columns:repeat(2,1fr)}
  .djembe-pads{grid-template-columns:repeat(4,1fr)}
  .tree-stat-bar{gap:1rem;padding:.7rem 1.2rem}
}
</style>
</head>
<body>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SAVANNAH INTRO
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="intro">
  <canvas id="intro-canvas"></canvas>
  <div id="intro-logo">
    <h1>Kwa <em>Sukela</em></h1>
    <p>Africa's Storytelling World Â· Est. 2026</p>
  </div>
  <button id="skip-btn" onclick="skipIntro()">Skip Intro</button>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   MAIN SITE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="site">
  <nav>
    <div class="nstrip"></div>
    <div class="nav-w">
      <a href="#" class="logo" onclick="showWorld('home')">Kwa <em>Sukela</em></a>
      <div class="nav-pills">
        <button class="npill active" onclick="showWorld('home')">ğŸ  Home</button>
        <button class="npill" onclick="showWorld('games')">ğŸ® Games</button>
        <button class="npill" onclick="showWorld('instruments')">ğŸ¥ Studio</button>
        <button class="npill" onclick="showWorld('brain')">ğŸ§  Brain Teasers</button>
        <button class="npill" onclick="showWorld('tree')">ğŸŒ³ Ancestor Tree</button>
        <button class="npill schools" onclick="showWorld('schools')">ğŸ“ Schools</button>
        <button class="npill" onclick="showWorld('audio')">ğŸµ Audio</button>
      </div>
    </div>
  </nav>

  <!-- HOME -->
  <div class="world active" id="home-world">
    <div class="home-hero">
      <div class="home-hero-l">
        <div class="home-hero-tag">South Africa's Storytelling Academy Â· 2026</div>
        <h1>Where Every<br><strong>Story</strong><em>Belongs.</em></h1>
        <p class="home-hero-sub">Six interactive worlds. One living community. Rooted in African tradition, built for every learner.</p>
        <div style="display:flex;gap:.7rem;flex-wrap:wrap">
          <button class="btn" onclick="showWorld('schools')">Start Learning</button>
          <button class="btn btn-out" style="border-color:rgba(255,255,255,.2);color:rgba(255,255,255,.6)" onclick="showWorld('games')">Explore Games</button>
        </div>
      </div>
      <div class="home-hero-r" id="heroFireflies"></div>
    </div>
    <div class="worlds-grid">
      <div class="world-card" onclick="showWorld('games')">
        <div class="wc-icon">ğŸŒ</div>
        <div class="wc-name">Indigenous Games</div>
        <div class="wc-sub">Mancala, Diketo, Kgati, Ncuva â€” African tradition meets digital play. Score. Level up. Win.</div>
        <div class="wc-tag">Savannah World Â· 4 Games</div>
      </div>
      <div class="world-card" onclick="showWorld('instruments')">
        <div class="wc-icon">ğŸ¥</div>
        <div class="wc-name">Music Studio</div>
        <div class="wc-sub">Play Djembe, Mbira, Hosho, Uhadi. Record your session. Share with the community.</div>
        <div class="wc-tag">4 Instruments Â· Record & Share</div>
      </div>
      <div class="world-card" onclick="showWorld('brain')">
        <div class="wc-icon">ğŸ§ </div>
        <div class="wc-name">Brain Teasers</div>
        <div class="wc-sub">Daily puzzles. African proverbs, IQ patterns, logic riddles, maths challenges. Build your streak.</div>
        <div class="wc-tag">Daily Challenge Â· 6 Puzzle Types</div>
      </div>
      <div class="world-card" onclick="showWorld('tree')">
        <div class="wc-icon">ğŸŒ³</div>
        <div class="wc-name">Ancestor Tree</div>
        <div class="wc-sub">A living tree that grows with every story, game and lesson you contribute. Your leaf lives here forever.</div>
        <div class="wc-tag">Community Â· Living World</div>
      </div>
      <div class="world-card" onclick="showWorld('schools')">
        <div class="wc-icon">ğŸ“</div>
        <div class="wc-name">Schools Hub</div>
        <div class="wc-sub">Grade 12 study notes for Maths, Physical Science, English, isiZulu, Life Sciences. CAPS-aligned.</div>
        <div class="wc-tag">Grade 12 Priority Â· CAPS 2025</div>
      </div>
      <div class="world-card" onclick="showWorld('audio')">
        <div class="wc-icon">ğŸµ</div>
        <div class="wc-name">Audio Archive</div>
        <div class="wc-sub">Umemulo songs, izinganekwane, lullabies, folklore. Dr Sasa's voice through every track.</div>
        <div class="wc-tag">Coming Soon Â· Subscribe</div>
      </div>
    </div>
    <!-- Community Wall Preview -->
    <div style="background:var(--ink2);padding:3rem 0">
      <div class="ctr">
        <div class="sec-lbl" style="color:rgba(255,255,255,.28)">Community</div>
        <h2 class="sec-title" style="color:#fff;margin-bottom:.4rem">Community <em>Wall</em></h2>
        <p style="font-size:.88rem;color:rgba(255,255,255,.38);margin-bottom:2rem;line-height:1.85">Music created here. Stories shared. Achievements celebrated.</p>
        <div class="wall-grid">
          <div class="wall-post"><span class="wp-type wp-music">ğŸµ Music</span><div class="wp-name">Thandi K. â€” Durban</div><div class="wp-content">My first mbira composition â€” a lullaby for my daughter</div><div class="wp-meta">2 hours ago Â· 12 â™¥</div><button class="wp-play">â–¶ Play</button></div>
          <div class="wall-post"><span class="wp-type wp-achieve">ğŸ… Achievement</span><div class="wp-name">Sipho M. â€” Johannesburg</div><div class="wp-content">30-day brain teaser streak completed! ğŸ”¥ Thanks Dr Sasa</div><div class="wp-meta">Yesterday Â· 34 â™¥</div></div>
          <div class="wall-post"><span class="wp-type wp-story">ğŸ“– Story</span><div class="wp-name">Nomvula D. â€” Cape Town</div><div class="wp-content">My grandmother's version of the Hare and the Tortoise â€” a Xhosa retelling</div><div class="wp-meta">3 days ago Â· 28 â™¥</div></div>
        </div>
      </div>
    </div>
  </div>

  <!-- GAMES WORLD -->
  <div class="world" id="games-world">
    <div class="savannah-hero">
      <div class="savannah-sky"></div>
      <div class="savannah-sun"></div>
      <svg class="acacia" style="left:5%;bottom:60px" width="90" height="100" viewBox="0 0 90 100"><rect x="40" y="30" width="8" height="70" fill="#2a1200"/><ellipse cx="45" cy="25" rx="40" ry="20" fill="#1a3a0a" opacity=".9"/><ellipse cx="20" cy="32" rx="22" ry="12" fill="#1a3a0a" opacity=".7"/><ellipse cx="70" cy="28" rx="24" ry="13" fill="#1a3a0a" opacity=".75"/></svg>
      <svg class="acacia" style="right:8%;bottom:60px" width="70" height="80" viewBox="0 0 70 80"><rect x="30" y="25" width="7" height="55" fill="#2a1200"/><ellipse cx="33" cy="20" rx="30" ry="16" fill="#1a3a0a" opacity=".85"/><ellipse cx="55" cy="26" rx="18" ry="10" fill="#1a3a0a" opacity=".7"/></svg>
      <div class="savannah-ground"></div>
      <div class="savannah-title"><h2>Indigenous Games</h2><p>African tradition Â· digital play Â· real competition</p></div>
    </div>
    <div class="ndebele-border"></div>
    <div class="games-body">
      <div class="ctr">
        <div style="margin:2rem 0">
          <div class="sec-lbl">Play & Learn</div>
          <h2 class="sec-title">Choose Your <em>Game</em></h2>
          <p class="sec-sub">Each game rooted in African tradition. Click to read the teaser, then dive in.</p>
        </div>
        <div class="games-grid">
          <!-- Mancala -->
          <div class="game-tile" onclick="openGame('mancala')">
            <div class="game-tile-hero gt-mancala">
              <svg width="140" height="80" viewBox="0 0 140 80"><rect x="10" y="20" width="120" height="40" rx="20" fill="rgba(255,255,255,.08)" stroke="rgba(255,215,0,.3)" stroke-width="2"/><circle cx="35" cy="40" r="12" fill="rgba(255,215,0,.15)" stroke="rgba(255,215,0,.4)" stroke-width="1.5"/><circle cx="65" cy="40" r="12" fill="rgba(255,215,0,.15)" stroke="rgba(255,215,0,.4)" stroke-width="1.5"/><circle cx="95" cy="40" r="12" fill="rgba(255,215,0,.15)" stroke="rgba(255,215,0,.4)" stroke-width="1.5"/><text x="35" y="44" text-anchor="middle" fill="#FFD700" font-size="11" font-weight="bold">4</text><text x="65" y="44" text-anchor="middle" fill="#FFD700" font-size="11" font-weight="bold">4</text><text x="95" y="44" text-anchor="middle" fill="#FFD700" font-size="11" font-weight="bold">4</text><circle cx="22" cy="40" r="8" fill="rgba(202,92,8,.3)" stroke="rgba(202,92,8,.6)" stroke-width="1.5"/><circle cx="118" cy="40" r="8" fill="rgba(46,143,204,.3)" stroke="rgba(46,143,204,.6)" stroke-width="1.5"/></svg>
            </div>
            <div class="game-tile-body">
              <div class="gt-tag">Strategy</div>
              <div class="gt-name">Mancala / Umlabalaba</div>
              <div class="gt-origin">ğŸŒ Across Sub-Saharan Africa Â· 7,000+ years old</div>
              <p class="gt-desc">Sow seeds around the board, capture your opponent's stones. One of the oldest strategy games on Earth â€” born in Africa. Takes 2 minutes to learn, a lifetime to master.</p>
              <div class="gt-stats"><div class="gt-stat"><strong>10</strong> Levels</div><div class="gt-stat"><strong>AI</strong> Opponent</div><div class="gt-stat"><strong>â˜…</strong> Scoring</div></div>
            </div>
          </div>
          <!-- Diketo -->
          <div class="game-tile" onclick="openGame('diketo')">
            <div class="game-tile-hero gt-diketo">
              <div style="font-size:3rem;text-align:center">ğŸª¨ğŸª¨ğŸª¨<br><span style="font-size:1.5rem;opacity:.6">tap the rhythm</span></div>
            </div>
            <div class="game-tile-body">
              <div class="gt-tag">Rhythm & Coordination</div>
              <div class="gt-name">Diketo</div>
              <div class="gt-origin">ğŸ‡¿ğŸ‡¦ Sotho tradition Â· South Africa</div>
              <p class="gt-desc">A stone is tossed, others swept, timing is everything. Digital Diketo is a rhythm challenge â€” watch the pattern, tap it back. Gets faster every level. Addictive.</p>
              <div class="gt-stats"><div class="gt-stat"><strong>20</strong> Levels</div><div class="gt-stat"><strong>Rhythm</strong> Based</div><div class="gt-stat"><strong>â†‘</strong> Speed</div></div>
            </div>
          </div>
          <!-- Kgati -->
          <div class="game-tile" onclick="openGame('kgati')">
            <div class="game-tile-hero gt-kgati">
              <div style="font-size:2.5rem;text-align:center;padding:1rem">ğŸª¢<br><span style="font-size:1rem;opacity:.6;display:block;margin-top:.5rem">read the pattern Â· jump in time</span></div>
            </div>
            <div class="game-tile-body">
              <div class="gt-tag">Pattern Logic</div>
              <div class="gt-name">Kgati</div>
              <div class="gt-origin">ğŸ‡¿ğŸ‡¦ Sotho & Tswana tradition</div>
              <p class="gt-desc">The digital rope never stops swinging. Read the jump pattern, input the right sequence before the rope catches you. Logic meets rhythm in this classic girls' game.</p>
              <div class="gt-stats"><div class="gt-stat"><strong>15</strong> Levels</div><div class="gt-stat"><strong>Pattern</strong> Logic</div><div class="gt-stat"><strong>âš¡</strong> Speed+</div></div>
            </div>
          </div>
          <!-- Ncuva -->
          <div class="game-tile" onclick="openGame('ncuva')">
            <div class="game-tile-hero gt-ncuva">
              <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:.5rem;padding:1.5rem;width:fit-content;margin:auto">
                <div style="width:32px;height:32px;border-radius:4px;background:rgba(255,215,0,.3);border:1.5px solid rgba(255,215,0,.5)"></div>
                <div style="width:32px;height:32px;border-radius:4px;background:rgba(202,92,8,.3);border:1.5px solid rgba(202,92,8,.5)"></div>
                <div style="width:32px;height:32px;border-radius:4px;background:rgba(255,215,0,.3);border:1.5px solid rgba(255,215,0,.5)"></div>
                <div style="width:32px;height:32px;border-radius:4px;background:rgba(255,255,255,.08)"></div>
                <div style="width:32px;height:32px;border-radius:4px;background:rgba(202,92,8,.3);border:1.5px solid rgba(202,92,8,.5)"></div>
                <div style="width:32px;height:32px;border-radius:4px;background:rgba(255,255,255,.08)"></div>
              </div>
            </div>
            <div class="game-tile-body">
              <div class="gt-tag">Memory & Pattern</div>
              <div class="gt-name">Ncuva</div>
              <div class="gt-origin">ğŸ‡¿ğŸ‡¦ Venda tradition Â· Limpopo</div>
              <p class="gt-desc">Patterns flash. Memorise them. Recreate them perfectly. Each round adds more complexity. Trains visual memory, focus and pattern recognition. Deeply satisfying.</p>
              <div class="gt-stats"><div class="gt-stat"><strong>12</strong> Levels</div><div class="gt-stat"><strong>Memory</strong> Training</div><div class="gt-stat"><strong>+</strong> Complexity</div></div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="ndebele-border"></div>
  </div>

  <!-- GAME OVERLAYS -->
  <div class="game-overlay" id="mancala-overlay">
    <div class="game-modal">
      <div class="gm-header"><div class="gm-title">ğŸŒ Mancala / Umlabalaba</div><button class="gm-close" onclick="closeGame('mancala')">âœ•</button></div>
      <div class="gm-body">
        <div class="gm-score-bar">
          <div class="gm-score-item"><span>Your Store</span><strong id="p1-store">0</strong></div>
          <div class="gm-score-item"><span>Level</span><strong id="m-level">1</strong></div>
          <div class="gm-score-item"><span>Moves</span><strong id="m-moves">0</strong></div>
          <div class="gm-score-item"><span>AI Store</span><strong id="p2-store">0</strong></div>
        </div>
        <div id="mancala-game">
          <div class="mancala-board">
            <div class="mancala-label">AI (North)</div>
            <div class="mancala-row">
              <div class="mancala-store"><strong id="store-p2">0</strong><span>AI</span></div>
              <div class="mancala-pits" id="ai-pits"></div>
              <div class="mancala-store"><strong id="store-p1">0</strong><span>You</span></div>
            </div>
            <div class="mancala-row">
              <div class="mancala-store" style="visibility:hidden"></div>
              <div class="mancala-pits" id="player-pits"></div>
              <div class="mancala-store" style="visibility:hidden"></div>
            </div>
            <div class="mancala-label">You (South)</div>
          </div>
          <div class="game-msg" id="m-msg">Your turn â€” click a pit to sow seeds</div>
          <div style="display:flex;gap:.7rem;margin-top:1rem;justify-content:center">
            <button class="btn" onclick="initMancala()">New Game</button>
            <button class="btn btn-out" onclick="closeGame('mancala')">Exit</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="game-overlay" id="diketo-overlay">
    <div class="game-modal">
      <div class="gm-header"><div class="gm-title">ğŸª¨ Diketo â€” Rhythm Challenge</div><button class="gm-close" onclick="closeGame('diketo')">âœ•</button></div>
      <div class="gm-body">
        <div class="gm-score-bar">
          <div class="gm-score-item"><span>Score</span><strong id="d-score">0</strong></div>
          <div class="gm-score-item"><span>Level</span><strong id="d-level">1</strong></div>
          <div class="gm-score-item"><span>Best</span><strong id="d-best">0</strong></div>
        </div>
        <div id="diketo-game">
          <div class="diketo-area">
            <p style="color:rgba(255,255,255,.5);font-size:.85rem;margin-bottom:1rem;line-height:1.65">Watch the pattern light up, then tap the stones in the same order.</p>
            <div class="diketo-sequence" id="diketo-seq"></div>
            <div class="game-msg" id="d-msg">Press Start to play</div>
            <button class="diketo-tap-btn" id="diketo-main-btn" onclick="diketoAction()">TAP</button>
            <div style="display:flex;gap:.7rem;justify-content:center;margin-top:.5rem">
              <button class="btn" onclick="startDiketo()">Start</button>
              <button class="btn btn-out" style="border-color:rgba(255,255,255,.2);color:rgba(255,255,255,.4)" onclick="closeGame('diketo')">Exit</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="game-overlay" id="kgati-overlay">
    <div class="game-modal">
      <div class="gm-header"><div class="gm-title">ğŸª¢ Kgati â€” Jump the Pattern</div><button class="gm-close" onclick="closeGame('kgati')">âœ•</button></div>
      <div class="gm-body">
        <div class="gm-score-bar">
          <div class="gm-score-item"><span>Score</span><strong id="k-score">0</strong></div>
          <div class="gm-score-item"><span>Level</span><strong id="k-level">1</strong></div>
          <div class="gm-score-item"><span>Lives</span><strong id="k-lives">3</strong></div>
        </div>
        <div id="kgati-game">
          <div class="kgati-rope-area"><div class="kgati-rope" id="kgati-rope"></div><div class="kgati-jumper" id="kgati-jumper">ğŸ§’</div></div>
          <p style="color:rgba(255,255,255,.5);font-size:.82rem;text-align:center;margin:.5rem 0">Select the correct jump sequence:</p>
          <div class="kgati-pattern" id="kgati-pattern"></div>
          <div class="game-msg" id="k-msg">Press Start</div>
          <div style="display:flex;gap:.7rem;justify-content:center;margin-top:.8rem">
            <button class="btn" onclick="startKgati()">Start</button>
            <button class="btn btn-out" style="border-color:rgba(255,255,255,.2);color:rgba(255,255,255,.4)" onclick="closeGame('kgati')">Exit</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="game-overlay" id="ncuva-overlay">
    <div class="game-modal">
      <div class="gm-header"><div class="gm-title">âœ¦ Ncuva â€” Remember the Pattern</div><button class="gm-close" onclick="closeGame('ncuva')">âœ•</button></div>
      <div class="gm-body">
        <div class="gm-score-bar">
          <div class="gm-score-item"><span>Score</span><strong id="n-score">0</strong></div>
          <div class="gm-score-item"><span>Level</span><strong id="n-level">1</strong></div>
          <div class="gm-score-item"><span>Best</span><strong id="n-best">0</strong></div>
        </div>
        <div id="ncuva-game">
          <div class="game-msg" id="n-msg">Press Start â€” memorise the pattern!</div>
          <div class="ncuva-grid" id="ncuva-grid"></div>
          <div style="display:flex;gap:.7rem;justify-content:center;margin-top:.8rem">
            <button class="btn" onclick="startNcuva()">Start</button>
            <button class="btn btn-out" style="border-color:rgba(255,255,255,.2);color:rgba(255,255,255,.4)" onclick="closeGame('ncuva')">Exit</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- INSTRUMENTS WORLD -->
  <div class="world" id="instruments-world">
    <div class="inst-hero">
      <div class="ctr">
        <div class="sec-lbl" style="color:rgba(255,255,255,.28);justify-content:center">Music Studio</div>
        <h2>African <em>Instrument Studio</em></h2>
        <p>Play. Record. Loop. Share. Four instruments, one recording session, one community wall.</p>
      </div>
    </div>
    <div class="ctr">
      <div class="studio">
        <div>
          <div class="inst-selector">
            <button class="inst-btn active" onclick="selectInst('djembe')"><span class="inst-emoji">ğŸ¥</span><span class="inst-name">Djembe</span><span class="inst-origin">West Africa Â· Percussion</span></button>
            <button class="inst-btn" onclick="selectInst('mbira')"><span class="inst-emoji">ğŸ¹</span><span class="inst-name">Mbira</span><span class="inst-origin">Zimbabwe Â· Thumb Piano</span></button>
            <button class="inst-btn" onclick="selectInst('hosho')"><span class="inst-emoji">ğŸª˜</span><span class="inst-name">Hosho</span><span class="inst-origin">Zimbabwe Â· Gourd Shaker</span></button>
            <button class="inst-btn" onclick="selectInst('uhadi')"><span class="inst-emoji">ğŸ»</span><span class="inst-name">Uhadi</span><span class="inst-origin">Xhosa Â· Musical Bow</span></button>
          </div>
          <div class="inst-play-area" id="inst-play-area">
            <!-- Djembe (default) -->
            <div class="inst-title-bar"><div class="inst-play-title">ğŸ¥ Djembe</div></div>
            <p class="inst-play-sub">8 zones â€” different tones. Bass (centre), tone (edge), slap (rim). Click or tap to play.</p>
            <div class="djembe-pads" id="djembe-pads">
              <div class="drum-pad dp1" data-note="C2" onclick="playDrum(this,'djembe','bass-l')">Bass L</div>
              <div class="drum-pad dp2" data-note="D2" onclick="playDrum(this,'djembe','tone-l')">Tone L</div>
              <div class="drum-pad dp3" data-note="E2" onclick="playDrum(this,'djembe','slap-l')">Slap L</div>
              <div class="drum-pad dp4" data-note="G2" onclick="playDrum(this,'djembe','open')">Open</div>
              <div class="drum-pad dp5" data-note="A2" onclick="playDrum(this,'djembe','slap-r')">Slap R</div>
              <div class="drum-pad dp6" data-note="B2" onclick="playDrum(this,'djembe','tone-r')">Tone R</div>
              <div class="drum-pad dp7" data-note="C3" onclick="playDrum(this,'djembe','bass-r')">Bass R</div>
              <div class="drum-pad dp8" data-note="D3" onclick="playDrum(this,'djembe','mute')">Mute</div>
            </div>
          </div>
        </div>
        <!-- Recorder Panel -->
        <div class="recorder-panel">
          <div class="rec-title">ğŸ”´ Recording Studio</div>
          <button class="rec-btn-main" id="rec-btn" onclick="toggleRecord()"></button>
          <div class="rec-status" id="rec-status">READY</div>
          <div class="rec-timeline"><div class="rec-wave" id="rec-wave"></div></div>
          <div class="rec-controls">
            <button class="rec-ctrl" id="play-ctrl" onclick="playback()">â–¶ Play</button>
            <button class="rec-ctrl" id="loop-ctrl" onclick="toggleLoop()">â†º Loop</button>
            <button class="rec-ctrl" onclick="clearRec()">âœ• Clear</button>
          </div>
          <button class="post-wall-btn" onclick="postToWall()">ğŸ“¤ Post to Community Wall</button>
          <div class="posted-notif" id="posted-notif">âœ“ Posted to Community Wall!</div>
        </div>
      </div>
    </div>
  </div>

  <!-- BRAIN TEASERS WORLD -->
  <div class="world" id="brain-world">
    <div class="brain-hero">
      <div class="ctr">
        <div class="sec-lbl" style="color:rgba(255,255,255,.28);justify-content:center">Daily Challenge</div>
        <h2>Brain <em>Teasers</em></h2>
        <p>Six puzzle types. One new challenge every day. Build your streak. Train your mind.</p>
        <div class="streak-bar">
          <div class="streak-fire">ğŸ”¥</div>
          <div class="streak-info"><strong id="streak-count">7</strong><span>Day Streak</span></div>
          <div class="streak-dots" id="streak-dots"></div>
        </div>
      </div>
    </div>
    <div class="ctr">
      <div class="puzzle-tabs">
        <button class="ptab active" onclick="setPuzzleType('proverb')">ğŸ“– Proverbs</button>
        <button class="ptab" onclick="setPuzzleType('pattern')">âœ¦ Patterns</button>
        <button class="ptab" onclick="setPuzzleType('logic')">ğŸ§© Logic</button>
        <button class="ptab" onclick="setPuzzleType('maths')">ğŸ“ Maths</button>
        <button class="ptab" onclick="setPuzzleType('science')">ğŸ”¬ Science</button>
        <button class="ptab" onclick="setPuzzleType('drum')">ğŸ¥ Drum Memory</button>
      </div>
      <div class="puzzle-stage" id="puzzle-stage">
        <!-- Puzzle renders here -->
      </div>
    </div>
  </div>

  <!-- ANCESTOR TREE WORLD -->
  <div class="world" id="tree-world">
    <div class="tree-canvas-wrap">
      <canvas id="tree-canvas"></canvas>
      <div class="tree-ui">
        <h2>The <em>Ancestor Tree</em></h2>
        <p>Every story told, game played, puzzle solved â€” grows this tree. Your leaf lives here. Forever.</p>
        <div class="tree-tooltip" id="tree-tooltip">ğŸŒ± Hover over a glowing leaf to see who it belongs to. Every leaf is a real learner who contributed to Kwa Sukela.</div>
        <div class="tree-actions">
          <button class="btn btn-blu" onclick="growLeaf()">ğŸŒ¿ Add Your Leaf</button>
          <button class="btn btn-out" style="border-color:rgba(100,181,232,.3);color:#64B5E8" onclick="showWorld('schools')">Go Learn â†’ Earn Leaves</button>
        </div>
      </div>
      <div class="tree-stat-bar">
        <div class="ts-item"><strong id="leaf-count">247</strong><span>Leaves</span></div>
        <div class="ts-item"><strong id="branch-count">8</strong><span>Branches</span></div>
        <div class="ts-item"><strong id="story-count">143</strong><span>Stories</span></div>
      </div>
      <div class="leaf-popup" id="leaf-popup"></div>
    </div>
  </div>

  <!-- SCHOOLS WORLD -->
  <div class="world" id="schools-world">
    <div class="schools-hero">
      <div class="ctr">
        <div class="sec-lbl" style="color:rgba(134,239,172,.5);justify-content:center">CAPS Aligned 2025</div>
        <h2>Schools <em>Hub</em></h2>
        <p>Study notes, key formulas, practice questions and Dr Sasa's exam tips. Free for every South African learner.</p>
        <div class="grade-pills">
          <button class="grade-pill priority active" onclick="setGrade(12)">Grade 12 â˜…</button>
          <button class="grade-pill" onclick="setGrade(11)">Grade 11</button>
          <button class="grade-pill" onclick="setGrade(10)">Grade 10</button>
        </div>
      </div>
    </div>
    <div class="ctr" style="padding-top:2.5rem">
      <div class="subjects-nav">
        <button class="sub-tab maths active" onclick="setSubject('maths')"><span class="sub-icon">ğŸ“</span>Mathematics</button>
        <button class="sub-tab science" onclick="setSubject('science')"><span class="sub-icon">ğŸ”¬</span>Physical Sciences</button>
        <button class="sub-tab" onclick="setSubject('english')"><span class="sub-icon">ğŸ“</span>English HL</button>
        <button class="sub-tab" onclick="setSubject('zulu')"><span class="sub-icon">ğŸ—£ï¸</span>isiZulu</button>
        <button class="sub-tab" onclick="setSubject('lifesci')"><span class="sub-icon">ğŸ§¬</span>Life Sciences</button>
      </div>
      <div class="topic-grid" id="topic-grid"></div>
      <div style="text-align:center;padding:1rem 0 3rem">
        <p style="font-size:.82rem;color:var(--i35);font-family:'JetBrains Mono',monospace;letter-spacing:.04em">Click any topic to open full study notes + practice questions + Dr Sasa's exam tips</p>
      </div>
    </div>
  </div>

  <!-- NOTES OVERLAY -->
  <div class="notes-overlay" id="notes-overlay">
    <div class="notes-modal">
      <div class="nm-header">
        <div class="nm-title" id="nm-title">Topic Notes</div>
        <button class="nm-close" onclick="closeNotes()">âœ•</button>
      </div>
      <div class="nm-body" id="nm-body"></div>
    </div>
  </div>

  <!-- AUDIO WORLD -->
  <div class="world" id="audio-world">
    <div class="audio-hero">
      <div class="vinyl"></div>
      <div class="ctr" style="position:relative;z-index:2">
        <div class="sec-lbl" style="color:rgba(255,215,0,.3);justify-content:center">Folklore & Song</div>
        <h2>Audio <em>Archive</em></h2>
        <p>Umemelo songs, izinganekwane, lullabies, ceremonial songs and Dr Sasa's lectures. Launching soon.</p>
      </div>
    </div>
    <div class="ctr">
      <div class="audio-grid">
        <div class="audio-card"><div class="ac-art ac-art-1"><span class="ac-vinyl-icon">ğŸ’ƒ</span><span class="ac-coming">Coming Soon</span></div><div class="ac-body"><div class="ac-name">Umemelo Songs</div><div class="ac-desc">Celebration songs performed at coming-of-age ceremonies. Joy, rhythm, community.</div><button class="ac-notify">Notify me when live</button></div></div>
        <div class="audio-card"><div class="ac-art ac-art-2"><span class="ac-vinyl-icon">ğŸ“–</span><span class="ac-coming">Coming Soon</span></div><div class="ac-body"><div class="ac-name">Izinganekwane</div><div class="ac-desc">Folktales told in the oral tradition â€” Dr Sasa's voice, firelight warmth, ancient stories.</div><button class="ac-notify">Notify me when live</button></div></div>
        <div class="audio-card"><div class="ac-art ac-art-3"><span class="ac-vinyl-icon">ğŸŒ™</span><span class="ac-coming">Coming Soon</span></div><div class="ac-body"><div class="ac-name">Lullabies</div><div class="ac-desc">Izihlabelelo â€” gentle songs carrying children into sleep and ancestors into memory.</div><button class="ac-notify">Notify me when live</button></div></div>
        <div class="audio-card"><div class="ac-art ac-art-4"><span class="ac-vinyl-icon">âš’ï¸</span><span class="ac-coming">Coming Soon</span></div><div class="ac-body"><div class="ac-name">Work Songs</div><div class="ac-desc">Songs that turned labour into music. The rhythm of building, harvest and community.</div><button class="ac-notify">Notify me when live</button></div></div>
        <div class="audio-card"><div class="ac-art ac-art-5"><span class="ac-vinyl-icon">ğŸŒ¿</span><span class="ac-coming">Coming Soon</span></div><div class="ac-body"><div class="ac-name">Ceremonial Songs</div><div class="ac-desc">Sacred songs for weddings, funerals, initiations â€” the sound of transition.</div><button class="ac-notify">Notify me when live</button></div></div>
        <div class="audio-card"><div class="ac-art ac-art-6"><span class="ac-vinyl-icon">ğŸ“</span><span class="ac-coming">Coming Soon</span></div><div class="ac-body"><div class="ac-name">Dr Sasa Lectures</div><div class="ac-desc">Audio versions of Dr Sasa's storytelling lectures and cultural talks.</div><button class="ac-notify">Notify me when live</button></div></div>
      </div>
    </div>
  </div>
</div><!-- /site -->

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SAVANNAH INTRO ANIMATION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const canvas=document.getElementById('intro-canvas');
const ctx=canvas.getContext('2d');
let introPhase=0,introT=0,introAnimId;
const acacias=[{x:.12,h:110,w:80},{x:.28,h:80,w:60},{x:.62,h:100,w:75},{x:.78,h:70,w:55},{x:.9,h:90,w:65}];
const animals=[{x:-.05,y:.0,s:'ğŸ¦’',speed:.0012},{x:.15,y:.02,s:'ğŸ¦',speed:.0008}];

function resizeCanvas(){canvas.width=window.innerWidth;canvas.height=window.innerHeight}
resizeCanvas();window.addEventListener('resize',resizeCanvas);

function drawSavannah(t){
  const W=canvas.width,H=canvas.height;
  const progress=Math.min(t/2,1);// 0â†’1 over 2 seconds
  const sunProgress=Math.min(t/3.5,1);
  // Sky gradient â€” dark to fiery sunrise
  const skyGrad=ctx.createLinearGradient(0,0,0,H);
  const night=[.04,.08,.16];
  const dawn=[1,.42,.13];
  const mid=[1,.58,.24];
  const r=Math.round(night[0]*255+(dawn[0]-night[0])*255*progress);
  const g=Math.round(night[1]*255+(dawn[1]-night[1])*255*progress);
  const b=Math.round(night[2]*255+(dawn[2]-night[2])*255*progress);
  skyGrad.addColorStop(0,`rgb(${Math.max(0,r-60)},${Math.max(0,g-40)},${Math.max(0,b-20)})`);
  skyGrad.addColorStop(.4,`rgb(${r},${g},${b})`);
  skyGrad.addColorStop(.7,`rgb(${Math.min(255,r+40)},${Math.min(255,g+60)},${Math.max(0,b-30)})`);
  skyGrad.addColorStop(1,`rgb(20,8,0)`);
  ctx.fillStyle=skyGrad;ctx.fillRect(0,0,W,H);
  // Stars fade out
  if(progress<.6){ctx.fillStyle=`rgba(255,255,255,${(1-progress*1.5)*0.5})`;
    for(let i=0;i<120;i++){const sx=(Math.sin(i*137.5)*0.5+0.5)*W,sy=(Math.sin(i*97.3)*0.5+0.5)*H*.5;ctx.fillRect(sx,sy,1,1)}}
  // Sun rising
  const groundY=H*.78;const sunY=groundY-(sunProgress*H*.42);const sunR=Math.max(0,40+sunProgress*20);
  const sunGrad=ctx.createRadialGradient(W/2,sunY,0,W/2,sunY,sunR*3);
  sunGrad.addColorStop(0,'rgba(255,240,100,.9)');sunGrad.addColorStop(.3,'rgba(255,160,30,.6)');sunGrad.addColorStop(1,'rgba(255,80,0,0)');
  ctx.fillStyle=sunGrad;ctx.beginPath();ctx.arc(W/2,sunY,sunR*3,0,Math.PI*2);ctx.fill();
  if(sunProgress>.1){ctx.fillStyle='rgba(255,220,50,.95)';ctx.beginPath();ctx.arc(W/2,sunY,sunR,0,Math.PI*2);ctx.fill()}
  // Ground
  const gGrad=ctx.createLinearGradient(0,groundY,0,H);
  gGrad.addColorStop(0,`rgba(80,35,5,${.4+progress*.5})`);gGrad.addColorStop(1,`rgba(20,8,0,${.5+progress*.5})`);
  ctx.fillStyle=gGrad;ctx.fillRect(0,groundY,W,H-groundY);
  // Grass horizon line
  if(progress>.3){const gAlpha=(progress-.3)/.7;ctx.fillStyle=`rgba(100,60,10,${gAlpha*.6})`;
    for(let i=0;i<60;i++){const gx=W*(i/60)+(Math.sin(i*3.7)*8);const gh=8+Math.sin(i*2.3)*4;ctx.fillRect(gx,groundY-gh,4,gh+4)}}
  // Acacia silhouettes
  acacias.forEach((a,i)=>{
    const ax=a.x*W,ay=groundY,opacity=Math.min(1,(progress-.1)/.6);if(opacity<=0)return;
    ctx.fillStyle=`rgba(15,6,0,${opacity})`;
    ctx.fillRect(ax-3,ay-a.h,6,a.h);// trunk
    ctx.beginPath();ctx.ellipse(ax,ay-a.h,a.w/2,a.h*.2,0,0,Math.PI*2);ctx.fill();
    ctx.beginPath();ctx.ellipse(ax-a.w*.25,ay-a.h+10,a.w*.3,a.h*.14,0,0,Math.PI*2);ctx.fill();
    ctx.beginPath();ctx.ellipse(ax+a.w*.25,ay-a.h+8,a.w*.28,a.h*.12,0,0,Math.PI*2);ctx.fill();
  });
  // Animals
  animals.forEach(a=>{
    a.x+=a.speed;if(a.x>1.1)a.x=-.1;
    ctx.font=`${H*.055}px serif`;ctx.fillText(a.s,a.x*W,groundY+10);
  });
}

function introLoop(ts){
  if(!introLoop.start)introLoop.start=ts;
  introT=(ts-introLoop.start)/1000;
  ctx.clearRect(0,0,canvas.width,canvas.height);
  drawSavannah(introT);
  if(introT>2&&introT<4){document.getElementById('intro-logo').classList.add('show')}
  if(introT>5){endIntro();return}
  introAnimId=requestAnimationFrame(introLoop);
}
requestAnimationFrame(introLoop);
function endIntro(){cancelAnimationFrame(introAnimId);document.getElementById('intro').classList.add('hide');document.getElementById('site').classList.add('show');setTimeout(()=>{document.getElementById('intro').style.display='none'},1400);initAll()}
function skipIntro(){endIntro()}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// WORLD NAVIGATION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function showWorld(id){
  document.querySelectorAll('.world').forEach(w=>w.classList.remove('active'));
  document.querySelectorAll('.npill').forEach(p=>p.classList.remove('active'));
  document.getElementById(id+'-world').classList.add('active');
  const pills=[...document.querySelectorAll('.npill')];
  const map={home:0,games:1,instruments:2,brain:3,tree:4,schools:5,audio:6};
  if(pills[map[id]])pills[map[id]].classList.add('active');
  window.scrollTo({top:0,behavior:'smooth'});
  if(id==='tree')initTree();
  if(id==='brain')initBrain();
}

function initAll(){
  initFireflies();
  initStreakDots();
  setSubject('maths');
  setPuzzleType('proverb');
  initBrain();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// FIREFLIES â€” HOME HERO
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function initFireflies(){
  const c=document.getElementById('heroFireflies');
  c.style.position='relative';
  const q=document.createElement('div');
  q.style.cssText='position:absolute;inset:0;display:flex;align-items:center;justify-content:center;z-index:2';
  q.innerHTML=`<div class="hero-r-content"><div class="hero-r-quote">"The story does not begin with the storyteller. It begins the moment the listener leans in."</div><div class="hero-r-attr">â€” Dr. Nomsa Mdlalose "Dr. Sasa"</div></div>`;
  c.appendChild(q);
  for(let i=0;i<18;i++){
    const f=document.createElement('div');f.className='firefly';
    const tx=(Math.random()-.5)*200,ty=(Math.random()-.5)*200;
    f.style.cssText=`left:${10+Math.random()*80}%;top:${10+Math.random()*80}%;--tx:${tx}px;--ty:${ty}px;animation:ff ${6+Math.random()*8}s ${Math.random()*6}s linear infinite;width:${2+Math.random()*2}px;height:${2+Math.random()*2}px;opacity:${.4+Math.random()*.6}`;
    c.appendChild(f);
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// MANCALA GAME
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let board={pits:[[4,4,4,4,4,4],[4,4,4,4,4,4]],stores:[0,0]},mTurn=0,mMoves=0,mLevel=1;
function initMancala(){
  board={pits:[[4,4,4,4,4,4],[4,4,4,4,4,4]],stores:[0,0]};mTurn=0;mMoves=0;
  renderMancala();setMMsg('Your turn â€” click a pit to sow seeds');
  document.getElementById('p1-store').textContent='0';document.getElementById('p2-store').textContent='0';document.getElementById('m-moves').textContent='0';
}
function renderMancala(){
  const pp=document.getElementById('player-pits'),ap=document.getElementById('ai-pits');
  pp.innerHTML='';ap.innerHTML='';
  document.getElementById('store-p1').textContent=board.stores[0];
  document.getElementById('store-p2').textContent=board.stores[1];
  // Player pits (row 0)
  board.pits[0].forEach((seeds,i)=>{
    const pit=document.createElement('div');pit.className='mancala-pit'+(mTurn!==0?' disabled':'');
    if(seeds===0||mTurn!==0)pit.classList.add('disabled');
    pit.setAttribute('data-pit',i);pit.setAttribute('data-row',0);
    const sd=document.createElement('div');sd.className='mancala-seeds';
    for(let s=0;s<Math.min(seeds,12);s++){const se=document.createElement('div');se.className='seed p1';sd.appendChild(se)}
    if(seeds>12){const txt=document.createElement('span');txt.style.cssText='font-size:.55rem;color:#FFD700;font-family:monospace';txt.textContent=seeds;pit.appendChild(txt)}
    else pit.appendChild(sd);
    if(seeds>0&&mTurn===0)pit.onclick=()=>sowSeeds(0,i);
    pp.appendChild(pit);
  });
  // AI pits (row 1, reversed for visual)
  [...board.pits[1]].reverse().forEach((seeds,i)=>{
    const pit=document.createElement('div');pit.className='mancala-pit disabled';
    const sd=document.createElement('div');sd.className='mancala-seeds';
    for(let s=0;s<Math.min(seeds,12);s++){const se=document.createElement('div');se.className='seed p2';sd.appendChild(se)}
    if(seeds>12){const txt=document.createElement('span');txt.style.cssText='font-size:.55rem;color:#64B5E8;font-family:monospace';txt.textContent=seeds;pit.appendChild(txt)}
    else pit.appendChild(sd);
    ap.appendChild(pit);
  });
  document.getElementById('p1-store').textContent=board.stores[0];
  document.getElementById('p2-store').textContent=board.stores[1];
}
function sowSeeds(row,pit){
  if(mTurn!==0||board.pits[row][pit]===0)return;
  let seeds=board.pits[row][pit];board.pits[row][pit]=0;
  let curRow=row,curPit=pit,extraTurn=false;
  while(seeds>0){
    curPit++;
    if(curRow===0&&curPit===6){board.stores[0]++;seeds--;if(seeds===0){extraTurn=true;break}curPit=-1;curRow=1;continue}
    if(curRow===1&&curPit===6){curPit=-1;curRow=0;continue}
    board.pits[curRow][curPit]++;seeds--;
    // Capture
    if(seeds===0&&curRow===0&&board.pits[0][curPit]===1&&board.pits[1][5-curPit]>0){
      board.stores[0]+=1+board.pits[1][5-curPit];board.pits[0][curPit]=0;board.pits[1][5-curPit]=0;
    }
  }
  mMoves++;document.getElementById('m-moves').textContent=mMoves;
  if(checkMancalaEnd())return;
  if(extraTurn){setMMsg('Extra turn! You landed in your store ğŸ‰');renderMancala();}
  else{mTurn=1;setMMsg('AI is thinking...');renderMancala();setTimeout(aiMove,900);}
}
function aiMove(){
  const validPits=board.pits[1].map((s,i)=>({s,i})).filter(p=>p.s>0);
  if(!validPits.length){mTurn=0;renderMancala();return}
  // Simple AI: prefer pit that lands in store
  let best=null;
  validPits.forEach(p=>{if(p.s===(6-p.i)){best=p}});
  if(!best)best=validPits[Math.floor(Math.random()*validPits.length)];
  let seeds=board.pits[1][best.i];board.pits[1][best.i]=0;
  let curRow=1,curPit=best.i,extraTurn=false;
  while(seeds>0){
    curPit++;
    if(curRow===1&&curPit===6){board.stores[1]++;seeds--;if(seeds===0){extraTurn=true;break}curPit=-1;curRow=0;continue}
    if(curRow===0&&curPit===6){curPit=-1;curRow=1;continue}
    board.pits[curRow][curPit]++;seeds--;
  }
  if(checkMancalaEnd())return;
  if(extraTurn){mTurn=1;setTimeout(aiMove,700);}
  else{mTurn=0;setMMsg('Your turn â€” click a pit');}
  renderMancala();
}
function checkMancalaEnd(){
  const p0empty=board.pits[0].every(s=>s===0);
  const p1empty=board.pits[1].every(s=>s===0);
  if(p0empty||p1empty){
    board.pits[1].forEach(s=>{board.stores[1]+=s});board.pits[1]=[0,0,0,0,0,0];
    board.pits[0].forEach(s=>{board.stores[0]+=s});board.pits[0]=[0,0,0,0,0,0];
    const w=board.stores[0]>board.stores[1]?'You win! ğŸ‰':board.stores[0]<board.stores[1]?'AI wins â€” try again!':'It\'s a draw!';
    setMMsg(w);mTurn=-1;renderMancala();return true;
  }return false;
}
function setMMsg(m){const el=document.getElementById('m-msg');if(el)el.textContent=m}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// DIKETO
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let diketoSeq=[],diketoPlayer=[],diketoState='idle',diketoScore=0,diketoBest=0,diketoLevel=1,diketoShowIdx=0;
const diketoEmojis=['ğŸª¨','ğŸŸ ','ğŸ”µ','ğŸŸ¢','ğŸŸ¡'];
function buildDiketoSeq(){
  const el=document.getElementById('diketo-seq');el.innerHTML='';
  const len=2+diketoLevel;if(diketoSeq.length<len)diketoSeq.push(Math.floor(Math.random()*diketoEmojis.length));
  diketoSeq.forEach((v,i)=>{
    const d=document.createElement('div');d.className='dseq-item';d.textContent=diketoEmojis[v];el.appendChild(d);
  });
}
function startDiketo(){
  diketoSeq=[];diketoPlayer=[];diketoState='showing';
  document.getElementById('d-msg').textContent='Watch carefully...';
  buildDiketoSeq();showDiketoPattern();
}
function showDiketoPattern(){
  const items=document.querySelectorAll('.dseq-item');
  diketoShowIdx=0;
  function flashNext(){
    if(diketoShowIdx>0)items[diketoShowIdx-1].classList.remove('active');
    if(diketoShowIdx>=items.length){
      setTimeout(()=>{diketoState='player';diketoPlayer=[];document.getElementById('d-msg').textContent='Your turn â€” tap in order!';},400);return;
    }
    items[diketoShowIdx].classList.add('active');diketoShowIdx++;
    setTimeout(flashNext,600+Math.max(0,200-diketoLevel*15));
  }
  setTimeout(flashNext,600);
}
function diketoAction(){
  if(diketoState!=='player')return;
  const expected=diketoSeq[diketoPlayer.length];
  const items=document.querySelectorAll('.dseq-item');
  items[diketoPlayer.length].classList.add('correct');
  diketoPlayer.push(expected);// simplified: always correct tap for now â€” remove for harder mode
  if(diketoPlayer.length===diketoSeq.length){
    diketoScore+=diketoLevel*10;diketoBest=Math.max(diketoScore,diketoBest);
    document.getElementById('d-score').textContent=diketoScore;document.getElementById('d-best').textContent=diketoBest;
    diketoLevel++;document.getElementById('d-level').textContent=diketoLevel;
    diketoState='showing';diketoPlayer=[];
    setTimeout(()=>{document.getElementById('d-msg').textContent='Well done! Next round...';buildDiketoSeq();setTimeout(showDiketoPattern,800);},600);
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// KGATI
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const kgatiMoves=['Jump','Skip','Step','Hop','Jump','Pause'];
let kgatiAnswer=[],kgatiSelected=[],kgatiLevel=1,kgatiScore=0,kgatiLives=3;
function startKgati(){
  kgatiLives=3;kgatiScore=0;kgatiLevel=1;
  document.getElementById('k-lives').textContent=kgatiLives;document.getElementById('k-score').textContent=kgatiScore;
  buildKgati();
}
function buildKgati(){
  document.getElementById('k-level').textContent=kgatiLevel;
  const len=2+kgatiLevel;kgatiAnswer=[];kgatiSelected=[];
  for(let i=0;i<len;i++)kgatiAnswer.push(Math.floor(Math.random()*kgatiMoves.length));
  const pat=document.getElementById('kgati-pattern');pat.innerHTML='';
  // Show 4 options to choose from
  const opts=[...new Set([...kgatiAnswer.slice(0,4).map(a=>kgatiMoves[a]),...kgatiMoves.slice(0,4)])].slice(0,4);
  opts.forEach(o=>{
    const b=document.createElement('div');b.className='kp-item';b.textContent=o;
    b.onclick=()=>kgatiSelect(o,b);pat.appendChild(b);
  });
  document.getElementById('k-msg').textContent=`Remember: ${kgatiAnswer.map(a=>kgatiMoves[a]).join(' â†’ ')}`;
  setTimeout(()=>{document.getElementById('k-msg').textContent='Now choose the sequence!';},2000+kgatiLevel*300);
}
function kgatiSelect(move,el){
  el.classList.add('sel');kgatiSelected.push(move);
  if(kgatiSelected.length===kgatiAnswer.length){
    const correct=kgatiSelected.every((m,i)=>m===kgatiMoves[kgatiAnswer[i]]);
    if(correct){
      const j=document.getElementById('kgati-jumper');j.classList.add('jump');setTimeout(()=>j.classList.remove('jump'),300);
      kgatiScore+=kgatiLevel*15;kgatiLevel++;
      document.getElementById('k-score').textContent=kgatiScore;document.getElementById('k-level').textContent=kgatiLevel;
      document.getElementById('k-msg').textContent='âœ“ Perfect! Next level!';
      setTimeout(buildKgati,1000);
    } else {
      kgatiLives--;document.getElementById('k-lives').textContent=kgatiLives;
      document.getElementById('k-msg').textContent=kgatiLives>0?'âœ— Wrong â€” try again!':'Game over!';
      if(kgatiLives>0)setTimeout(buildKgati,1200);
    }
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// NCUVA
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let ncuvaPattern=[],ncuvaUserPicks=[],ncuvaLevel=1,ncuvaScore=0,ncuvaBest=0,ncuvaState='idle';
const ncuvaEmojis=['ğŸ”´','ğŸŸ¡','ğŸ”µ','ğŸŸ¢','ğŸŸ ','âšª'];
function initNcuvaGrid(){
  const g=document.getElementById('ncuva-grid');g.innerHTML='';
  for(let i=0;i<16;i++){
    const c=document.createElement('div');c.className='ncuva-cell';c.setAttribute('data-idx',i);
    c.textContent=ncuvaEmojis[Math.floor(Math.random()*4)];
    c.onclick=()=>ncuvaPick(i,c);g.appendChild(c);
  }
}
function startNcuva(){
  ncuvaLevel=1;ncuvaScore=0;ncuvaBest=Math.max(ncuvaBest,0);ncuvaState='showing';
  initNcuvaGrid();showNcuvaPattern();
}
function showNcuvaPattern(){
  const len=2+ncuvaLevel;ncuvaPattern=[];ncuvaUserPicks=[];
  const cells=document.querySelectorAll('.ncuva-cell');
  for(let i=0;i<len;i++){let idx;do{idx=Math.floor(Math.random()*16)}while(ncuvaPattern.includes(idx));ncuvaPattern.push(idx);}
  document.getElementById('n-msg').textContent='Memorise the pattern!';
  ncuvaPattern.forEach((idx,i)=>{
    setTimeout(()=>{cells[idx].classList.add('lit');setTimeout(()=>cells[idx].classList.remove('lit'),500);},i*600);
  });
  setTimeout(()=>{ncuvaState='player';document.getElementById('n-msg').textContent='Now tap the same cells!';},ncuvaPattern.length*600+400);
}
function ncuvaPick(idx,el){
  if(ncuvaState!=='player')return;
  ncuvaUserPicks.push(idx);
  const expected=ncuvaPattern[ncuvaUserPicks.length-1];
  if(idx===expected){el.classList.add('correct');
    if(ncuvaUserPicks.length===ncuvaPattern.length){
      ncuvaScore+=ncuvaLevel*12;ncuvaLevel++;ncuvaBest=Math.max(ncuvaScore,ncuvaBest);
      document.getElementById('n-score').textContent=ncuvaScore;document.getElementById('n-best').textContent=ncuvaBest;document.getElementById('n-level').textContent=ncuvaLevel;
      document.getElementById('n-msg').textContent='âœ“ Perfect memory!';ncuvaState='idle';
      setTimeout(()=>{initNcuvaGrid();showNcuvaPattern();},1000);
    }
  } else {el.classList.add('wrong');document.getElementById('n-msg').textContent='âœ— Wrong cell! Try again.';ncuvaState='idle';setTimeout(startNcuva,1200);}
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// GAME OVERLAY MANAGEMENT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function openGame(g){
  const ov=document.getElementById(g+'-overlay');if(!ov)return;
  ov.classList.add('open');
  if(g==='mancala')initMancala();
  if(g==='ncuva')initNcuvaGrid();
}
function closeGame(g){document.getElementById(g+'-overlay').classList.remove('open')}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// INSTRUMENTS + AUDIO ENGINE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const AudioCtx=window.AudioContext||window.webkitAudioContext;
let audioCtx=null;function getACtx(){if(!audioCtx)audioCtx=new AudioCtx();if(audioCtx.state==='suspended')audioCtx.resume();return audioCtx}
let isRecording=false,recData=[],loopActive=false,recTimer=null;
const waveBars=[];

function playDrum(el,inst,zone){
  el.classList.add('hit');setTimeout(()=>el.classList.remove('hit'),120);
  const ac=getACtx();const o=ac.createOscillator(),g=ac.createGain();
  const freqs={bass:55,tone:110,slap:220,open:80,mute:70};
  const types={bass:'sine',tone:'triangle',slap:'sawtooth',open:'sine',mute:'square'};
  const zBase=zone.split('-')[0];
  o.frequency.setValueAtTime(freqs[zBase]||100,ac.currentTime);
  o.type=types[zBase]||'sine';
  g.gain.setValueAtTime(.7,ac.currentTime);g.gain.exponentialRampToValueAtTime(.001,ac.currentTime+.3);
  o.connect(g);g.connect(ac.destination);o.start();o.stop(ac.currentTime+.3);
  if(isRecording){recData.push({t:Date.now(),inst,zone});addWaveBar()}
}
function playMbira(el,freq){
  el.classList.add('hit');setTimeout(()=>el.classList.remove('hit'),200);
  const ac=getACtx();const o=ac.createOscillator(),g=ac.createGain();
  o.type='triangle';o.frequency.setValueAtTime(freq,ac.currentTime);
  g.gain.setValueAtTime(.5,ac.currentTime);g.gain.exponentialRampToValueAtTime(.001,ac.currentTime+1.2);
  o.connect(g);g.connect(ac.destination);o.start();o.stop(ac.currentTime+1.2);
  if(isRecording){recData.push({t:Date.now(),inst:'mbira',freq});addWaveBar()}
}
function playHosho(){
  const ac=getACtx();const buf=ac.createBuffer(1,ac.sampleRate*.15,ac.sampleRate);
  const data=buf.getChannelData(0);for(let i=0;i<data.length;i++)data[i]=(Math.random()*2-1)*Math.exp(-i/3000);
  const src=ac.createBufferSource(),g=ac.createGain();
  src.buffer=buf;g.gain.setValueAtTime(.6,ac.currentTime);src.connect(g);g.connect(ac.destination);src.start();
  if(isRecording){recData.push({t:Date.now(),inst:'hosho'});addWaveBar()}
}
function playUhadi(el,freq){
  el.classList.add('pluck');setTimeout(()=>el.classList.remove('pluck'),300);
  const ac=getACtx();const o=ac.createOscillator(),g=ac.createGain();
  o.type='sawtooth';o.frequency.setValueAtTime(freq,ac.currentTime);
  g.gain.setValueAtTime(.4,ac.currentTime);g.gain.exponentialRampToValueAtTime(.001,ac.currentTime+2.5);
  o.connect(g);g.connect(ac.destination);o.start();o.stop(ac.currentTime+2.5);
  if(isRecording){recData.push({t:Date.now(),inst:'uhadi',freq});addWaveBar()}
}
function addWaveBar(){
  const wave=document.getElementById('rec-wave');const b=document.createElement('div');
  b.className='rec-bar';const h=20+Math.random()*18;b.style.height=h+'px';wave.appendChild(b);
  if(wave.children.length>60)wave.removeChild(wave.firstChild);
}
function toggleRecord(){
  isRecording=!isRecording;const btn=document.getElementById('rec-btn');
  btn.classList.toggle('recording',isRecording);
  document.getElementById('rec-status').textContent=isRecording?'â— RECORDING':'READY';
  if(isRecording){recData=[];document.getElementById('rec-wave').innerHTML=''}
}
function playback(){
  if(!recData.length)return;getACtx();
  document.getElementById('play-ctrl').classList.add('active');
  setTimeout(()=>document.getElementById('play-ctrl').classList.remove('active'),600);
}
function toggleLoop(){loopActive=!loopActive;document.getElementById('loop-ctrl').classList.toggle('active',loopActive)}
function clearRec(){recData=[];document.getElementById('rec-wave').innerHTML='';document.getElementById('posted-notif').style.display='none'}
function postToWall(){
  const n=document.getElementById('posted-notif');n.style.display='block';
  setTimeout(()=>n.style.display='none',3000);
}

let currentInst='djembe';
function selectInst(inst){
  currentInst=inst;
  document.querySelectorAll('.inst-btn').forEach(b=>b.classList.remove('active'));
  event.currentTarget.classList.add('active');
  const area=document.getElementById('inst-play-area');
  const mbiraFreqs=[130,146,165,175,196,220,247,262,294,330,350,392];
  const mbiraNames=['C3','D3','E3','F3','G3','A3','B3','C4','D4','E4','F4','G4'];
  const uhadiFreqs=[82,110,146];const uhadiNames=['Low','Mid','High'];
  const maps={
    djembe:`<div class="inst-title-bar"><div class="inst-play-title">ğŸ¥ Djembe</div></div><p class="inst-play-sub">8 zones â€” bass, tone, slap. The heartbeat of West Africa.</p><div class="djembe-pads"><div class="drum-pad dp1" onclick="playDrum(this,'djembe','bass')">Bass L</div><div class="drum-pad dp2" onclick="playDrum(this,'djembe','tone')">Tone L</div><div class="drum-pad dp3" onclick="playDrum(this,'djembe','slap')">Slap L</div><div class="drum-pad dp4" onclick="playDrum(this,'djembe','open')">Open</div><div class="drum-pad dp5" onclick="playDrum(this,'djembe','slap')">Slap R</div><div class="drum-pad dp6" onclick="playDrum(this,'djembe','tone')">Tone R</div><div class="drum-pad dp7" onclick="playDrum(this,'djembe','bass')">Bass R</div><div class="drum-pad dp8" onclick="playDrum(this,'djembe','mute')">Mute</div></div>`,
    hosho:`<div class="inst-title-bar"><div class="inst-play-title">ğŸª˜ Hosho</div></div><p class="inst-play-sub">The gourd shaker of Zimbabwe. Shake the rhythm that holds everything together.</p><div class="hosho-area"><div class="hosho-gourd" onclick="playHosho();this.classList.add('shake');setTimeout(()=>this.classList.remove('shake'),150)">ğŸª˜</div><p style="color:rgba(255,255,255,.35);font-size:.78rem">Tap the gourd to shake it. Try different rhythms.</p></div>`,
    uhadi:`<div class="inst-title-bar"><div class="inst-play-title">ğŸ» Uhadi</div></div><p class="inst-play-sub">The Xhosa musical bow. Three tones â€” mournful, searching, hopeful.</p><div class="uhadi-strings">${uhadiFreqs.map((f,i)=>`<div class="uhadi-string" onclick="playUhadi(this,${f})"><div class="uhadi-stick" style="background:linear-gradient(180deg,${['#E6B32A','#CA5C08','#2E8FCC'][i]},rgba(255,255,255,.1));height:${120+i*20}px"></div><div class="uhadi-label">${uhadiNames[i]}</div></div>`).join('')}</div>`,
    mbira:`<div class="inst-title-bar"><div class="inst-play-title">ğŸ¹ Mbira</div></div><p class="inst-play-sub">The thumb piano of Zimbabwe. 12 keys â€” each a different voice speaking to the ancestors.</p><div class="mbira-keys">${mbiraFreqs.map((f,i)=>`<div class="mbira-key" style="height:${100+i*6}px;background:linear-gradient(180deg,${i%2===0?'#8B6914,#5A4008':'#5A4008,#3A2800'})" onclick="playMbira(this,${f})"><span class="mkey-label">${mbiraNames[i]}</span></div>`).join('')}</div>`
  };
  area.innerHTML=maps[inst]||maps.djembe;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// BRAIN TEASERS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let streakDays=7,currentPuzzleType='proverb',puzzleScore=0;
function initStreakDots(){
  const d=document.getElementById('streak-dots');if(!d)return;d.innerHTML='';
  for(let i=0;i<7;i++){const s=document.createElement('div');s.className='sd'+(i<streakDays?' done':'')+(i===streakDays-1?' today':'');d.appendChild(s)}
}
function initBrain(){initStreakDots();setPuzzleType('proverb')}
function setPuzzleType(t){
  currentPuzzleType=t;
  document.querySelectorAll('.ptab').forEach(p=>p.classList.remove('active'));
  const tabs=['proverb','pattern','logic','maths','science','drum'];
  const el=document.querySelectorAll('.ptab')[tabs.indexOf(t)];if(el)el.classList.add('active');
  renderPuzzle(t);
}

const puzzles={
  proverb:[
    {q:'Complete the Zulu proverb: <strong>"Umuntu ngumuntu nga___"</strong>',ans:'muntu',opts:['muntu','ntu','bantu','untu'],meaning:'A person is a person through other people â€” Ubuntu'},
    {q:'Complete: <strong>"Izandla ziyahlambana"</strong> â€” Hands wash each ___',ans:'other',opts:['other','themselves','alone','together'],meaning:'We need each other â€” cooperation'},
    {q:'Fill in: <strong>"Ukuphila impilo___"</strong> â€” Living life is ___',ans:'yempilo',opts:['yempilo','yomdlalo','yokufa','yokuwa'],meaning:'Life itself is the reward of living well'},
    {q:'Complete: <strong>"Isandla sihlamba esinye"</strong> â€” One hand washes the ___',ans:'other',opts:['other','face','body','ground'],meaning:'Reciprocity and mutual help'},
  ],
  pattern:[
    {q:'What comes next? <strong>ğŸ”º ğŸ”· ğŸ”º ğŸ”· ğŸ”º ___</strong>',opts:['ğŸ”·','ğŸ”º','ğŸŸ¡','â¬›'],ans:'ğŸ”·',meaning:'Alternating pattern'},
    {q:'Complete the sequence: <strong>2, 4, 8, 16, ___</strong>',opts:['24','32','30','28'],ans:'32',meaning:'Multiply by 2 each time'},
    {q:'Next in sequence: <strong>ğŸŒ™ â­ ğŸŒ™ â­ â­ ğŸŒ™ â­ â­ â­ ___</strong>',opts:['ğŸŒ™','â­â­','â­','ğŸŒŸ'],ans:'ğŸŒ™',meaning:'Stars increase by 1 each cycle'},
    {q:'What is next: <strong>1, 1, 2, 3, 5, 8, ___</strong>',opts:['11','12','13','14'],ans:'13',meaning:'Fibonacci â€” add the two before it'},
  ],
  logic:[
    {q:'Nandi has 3 calabashes. She must cross a river in a boat that holds only 2. What is the <strong>minimum number of trips</strong> she needs?',opts:['2','3','4','5'],ans:'3',meaning:'Trip 1: 2 calabashes. Trip 2: return with 1. Trip 3: final 2.'},
    {q:'A storyteller tells a story to 2 people. Each tells 2 others. Each of those tells 2 more. After 4 rounds, how many people have heard the story?',opts:['16','30','32','31'],ans:'31',meaning:'2+4+8+16+1(original) = 31'},
    {q:'If all izinganekwane are stories, and all stories teach lessons â€” do all izinganekwane teach lessons?',opts:['Yes, always','No, never','Sometimes','Cannot tell'],ans:'Yes, always',meaning:'Logical syllogism â€” transitive property'},
  ],
  maths:[
    {q:'<div class="maths-scenario"><div class="ms-lbl">ğŸ“ Real World Maths</div><div class="ms-story">A baobab tree grows 2.3 cm per year. It is currently 14 metres tall. Approximately how old is this baobab?</div></div>',opts:['600 years','609 years','570 years','650 years'],ans:'609 years',meaning:'14m = 1400cm Ã· 2.3 â‰ˆ 608.7 â‰ˆ 609 years'},
    {q:'<div class="maths-scenario"><div class="ms-lbl">ğŸ“Š Statistics</div><div class="ms-story">In a village of 240 people, 3 out of every 8 attend the weekly storytelling circle. How many people attend?</div></div>',opts:['80','90','100','75'],ans:'90',meaning:'240 Ã— (3/8) = 90 people'},
    {q:'<div class="maths-scenario"><div class="ms-lbl">ğŸ“ Calculus Application</div><div class="ms-story">The area of a circular drum skin is increasing at 4 cmÂ²/s. When the radius is 10 cm, how fast is the radius increasing? (A=Ï€rÂ²)</div></div>',opts:['0.064 cm/s','0.127 cm/s','0.2 cm/s','0.318 cm/s'],ans:'0.064 cm/s',meaning:'dA/dt = 2Ï€r Â· dr/dt â†’ dr/dt = 4Ã·(2Ï€Ã—10) â‰ˆ 0.064'},
    {q:'<div class="maths-scenario"><div class="ms-lbl">ğŸ’° Financial Maths</div><div class="ms-story">A Zintsomi course costs R3 500. A student saves R250/month. The price increases 8% per year. Will they afford it after 12 months of saving?</div></div>',opts:['Yes, R3000 saved vs R3500','No, R3000 saved vs R3780','Yes, just enough','Cannot determine'],ans:'No, R3000 saved vs R3780',meaning:'R250Ã—12=R3000 saved. Price: R3500Ã—1.08=R3780. Gap of R780.'},
  ],
  science:[
    {q:'<div class="maths-scenario"><div class="ms-lbl">âš¡ Physics â€” Momentum</div><div class="ms-story">A 60 kg drummer strikes a drum with a stick of mass 0.2 kg moving at 8 m/s. The stick stops in 0.05 s. What is the impulse?</div></div>',opts:['1.6 NÂ·s','0.8 NÂ·s','3.2 NÂ·s','0.4 NÂ·s'],ans:'1.6 NÂ·s',meaning:'Impulse = mÎ”v = 0.2Ã—8 = 1.6 NÂ·s'},
    {q:'<div class="maths-scenario"><div class="ms-lbl">ğŸ§ª Chemistry â€” pH</div><div class="ms-story">Dr Sasa is making traditional soap. The solution has [Hâº] = 1Ã—10â»Â¹Â² mol/L. Is this acid, base, or neutral?</div></div>',opts:['Acid (pH 12)','Base (pH 12)','Neutral','Cannot tell'],ans:'Base (pH 12)',meaning:'pH = -log(10â»Â¹Â²) = 12. Above 7 = basic/alkaline.'},
    {q:'<div class="maths-scenario"><div class="ms-lbl">âš¡ Physics â€” Work & Energy</div><div class="ms-story">A storyteller carries a 15 kg drum 200 m up a hill inclined at 30Â°. How much work is done against gravity? (g=9.8)</div></div>',opts:['14 700 J','7 350 J','29 400 J','3 675 J'],ans:'14 700 J',meaning:'W = mgh = 15Ã—9.8Ã—(200Ã—sin30Â°) = 15Ã—9.8Ã—100 = 14700 J'},
    {q:'A gene for skin pigmentation is on an autosome. If both parents are heterozygous (Aa Ã— Aa), what % of offspring will be homozygous recessive (aa)?',opts:['25%','50%','75%','0%'],ans:'25%',meaning:'Punnett square: AA(25%) Aa(50%) aa(25%)'},
  ],
  drum:[
    {pattern:['ğŸ¥','â€¢','ğŸ¥','ğŸ¥','â€¢','ğŸ¥'],answer:5,q:'Listen to the pattern. How many beats are in this sequence?'},
    {pattern:['ğŸ¥','ğŸ¥','â€¢','ğŸ¥','â€¢','â€¢','ğŸ¥'],answer:4,q:'Count only the drum HITS (ğŸ¥), not the rests (â€¢):'},
    {pattern:['ğŸ¥','â€¢','â€¢','ğŸ¥','ğŸ¥','â€¢','ğŸ¥','â€¢','ğŸ¥'],answer:5,q:'How many drum hits?'},
  ]
};

let currentPuzzleIdx=0;
function renderPuzzle(type){
  const stage=document.getElementById('puzzle-stage');
  if(type==='drum'){renderDrumPuzzle();return}
  const pArr=puzzles[type];if(!pArr||!pArr.length){stage.innerHTML='<p style="color:var(--i60);font-style:italic">More puzzles coming soon...</p>';return}
  const p=pArr[currentPuzzleIdx%pArr.length];
  stage.innerHTML=`
    <div class="puzzle-q">${p.q}</div>
    <div class="puzzle-options" id="popts"></div>
    <div class="puzzle-result" id="presult"></div>
    <div class="puzzle-nav">
      <div class="puzzle-points">+${10+(type==='maths'||type==='science'?15:0)} pts per correct</div>
      <div style="display:flex;gap:.6rem">
        <button class="btn btn-out" onclick="prevPuzzle()">â† Prev</button>
        <button class="btn" onclick="nextPuzzle()">Next â†’</button>
      </div>
    </div>`;
  const opts=document.getElementById('popts');
  p.opts.forEach(o=>{
    const b=document.createElement('button');b.className='p-opt';b.textContent=o;
    b.onclick=()=>checkAnswer(o,p.ans,p.meaning,b);opts.appendChild(b);
  });
}
function checkAnswer(chosen,correct,meaning,el){
  document.querySelectorAll('.p-opt').forEach(b=>b.classList.add('disabled'));
  const res=document.getElementById('presult');
  if(chosen===correct){el.classList.add('correct');res.className='puzzle-result correct';res.textContent=`âœ“ Correct! ${meaning}`;puzzleScore+=20}
  else{el.classList.add('wrong');res.className='puzzle-result wrong';res.textContent=`âœ— The answer is "${correct}". ${meaning}`;document.querySelectorAll('.p-opt').forEach(b=>{if(b.textContent===correct)b.classList.add('correct')})}
  res.style.display='block';
}
function nextPuzzle(){currentPuzzleIdx++;renderPuzzle(currentPuzzleType)}
function prevPuzzle(){currentPuzzleIdx=Math.max(0,currentPuzzleIdx-1);renderPuzzle(currentPuzzleType)}
function renderDrumPuzzle(){
  const stage=document.getElementById('puzzle-stage');
  const p=puzzles.drum[currentPuzzleIdx%puzzles.drum.length];
  stage.innerHTML=`
    <div class="puzzle-q">${p.q}</div>
    <div class="drum-sequence">${p.pattern.map(b=>`<div class="drum-beat">${b}</div>`).join('')}</div>
    <div class="puzzle-options" id="popts"></div>
    <div class="puzzle-result" id="presult"></div>
    <div class="puzzle-nav"><div class="puzzle-points">+20 pts</div><div style="display:flex;gap:.6rem"><button class="btn btn-out" onclick="prevPuzzle()">â† Prev</button><button class="btn" onclick="nextPuzzle()">Next â†’</button></div></div>`;
  const opts=document.getElementById('popts');
  [p.answer-2,p.answer-1,p.answer,p.answer+1].sort(()=>Math.random()-.5).forEach(o=>{
    const b=document.createElement('button');b.className='p-opt';b.textContent=o;
    b.onclick=()=>checkAnswer(String(o),String(p.answer),'Count the ğŸ¥ symbols â€” each is one beat.',b);opts.appendChild(b);
  });
  // Animate beats
  const beats=document.querySelectorAll('.drum-beat');
  let i=0;const anim=setInterval(()=>{if(i>0)beats[i-1].classList.remove('active');if(i>=beats.length){clearInterval(anim);return}beats[i].classList.add('active');i++;},400);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ANCESTOR TREE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let treeCanvas,treeCtx,leaves=[],fireflies2=[],treeGrowth=0.7;
const leafPeople=['Thandi Â· Durban','Sipho Â· JHB','Nomvula Â· CT','Lerato Â· Pretoria','Ayanda Â· PE','Bongani Â· Soweto','Zanele Â· Bloemfontein','Kagiso Â· Kimberley','Mihlali Â· East London','Tebogo Â· Polokwane'];

function initTree(){
  treeCanvas=document.getElementById('tree-canvas');if(!treeCanvas)return;
  treeCtx=treeCanvas.getContext('2d');
  treeCanvas.width=treeCanvas.offsetWidth;treeCanvas.height=treeCanvas.offsetHeight;
  leaves=[];fireflies2=[];
  // Generate leaves
  for(let i=0;i<247;i++){
    const angle=Math.random()*Math.PI*2;const dist=50+Math.random()*120;
    const cx=treeCanvas.width/2,cy=treeCanvas.height*.55;
    leaves.push({x:cx+Math.cos(angle)*dist*(treeGrowth+.3),y:cy-80-Math.random()*dist*.8,size:3+Math.random()*5,glow:Math.random()>.85,person:leafPeople[Math.floor(Math.random()*leafPeople.length)],hue:90+Math.random()*60,alpha:0.5+Math.random()*.5});
  }
  for(let i=0;i<30;i++){fireflies2.push({x:Math.random()*treeCanvas.width,y:Math.random()*treeCanvas.height,vx:(Math.random()-.5)*.8,vy:(Math.random()-.5)*.8,alpha:Math.random(),phase:Math.random()*Math.PI*2})}
  treeCanvas.addEventListener('mousemove',treeHover);
  treeLoop();
}
function treeLoop(){
  const tc=treeCanvas,tx=treeCtx;if(!tc)return;
  tc.width=tc.offsetWidth;tc.height=tc.offsetHeight;
  const W=tc.width,H=tc.height,cx=W/2,cy=H*.6;
  // Sky
  const sky=tx.createRadialGradient(cx,cy*.3,0,cx,cy*.3,W*.8);
  sky.addColorStop(0,'#020d1a');sky.addColorStop(.5,'#030f20');sky.addColorStop(1,'#010810');
  tx.fillStyle=sky;tx.fillRect(0,0,W,H);
  // Stars
  tx.fillStyle='rgba(255,255,255,0.6)';
  for(let i=0;i<200;i++){const sx=(Math.sin(i*137.5)*.5+.5)*W,sy=(Math.sin(i*97.3)*.5+.5)*H*.5;tx.fillRect(sx,sy,1,1)}
  // Ground glow
  const gGlow=tx.createRadialGradient(cx,H,0,cx,H,W*.5);
  gGlow.addColorStop(0,'rgba(0,80,20,.15)');gGlow.addColorStop(1,'transparent');
  tx.fillStyle=gGlow;tx.fillRect(0,0,W,H);
  // Draw tree trunk
  drawTree(tx,cx,cy,W*.013,90,-Math.PI/2,6,treeGrowth);
  // Leaves
  const t=Date.now()/1000;
  leaves.forEach(l=>{
    const pulse=l.glow?(Math.sin(t*2+l.hue)*.5+.5):0;
    if(l.glow){tx.shadowBlur=12+pulse*8;tx.shadowColor=`hsl(${l.hue},80%,60%)`}
    else tx.shadowBlur=0;
    tx.globalAlpha=l.alpha;
    tx.fillStyle=`hsl(${l.hue},${60+pulse*20}%,${30+pulse*20}%)`;
    tx.beginPath();tx.arc(l.x,l.y,l.size*(1+pulse*.3),0,Math.PI*2);tx.fill();
    tx.globalAlpha=1;tx.shadowBlur=0;
  });
  // Root glow
  const rootGlow=tx.createRadialGradient(cx,cy,0,cx,cy,120);
  rootGlow.addColorStop(0,`rgba(100,181,232,${.08+Math.sin(t*.8)*.04})`);rootGlow.addColorStop(1,'transparent');
  tx.fillStyle=rootGlow;tx.beginPath();tx.ellipse(cx,cy,120,40,0,0,Math.PI*2);tx.fill();
  // Fireflies
  fireflies2.forEach(f=>{
    f.x+=f.vx;f.y+=f.vy;f.phase+=.04;
    if(f.x<0||f.x>W)f.vx*=-1;if(f.y<0||f.y>H)f.vy*=-1;
    tx.globalAlpha=Math.sin(f.phase)*.5+.3;
    tx.fillStyle='#FFD700';tx.shadowBlur=8;tx.shadowColor='#FFD700';
    tx.beginPath();tx.arc(f.x,f.y,1.5,0,Math.PI*2);tx.fill();
    tx.globalAlpha=1;tx.shadowBlur=0;
  });
  requestAnimationFrame(treeLoop);
}
function drawTree(ctx,x,y,w,len,angle,depth,growth){
  if(depth===0||w<1)return;
  const nx=x+Math.cos(angle)*len*growth,ny=y+Math.sin(angle)*len*growth;
  ctx.strokeStyle=`rgba(${100-depth*8},${60+depth*5},20,${.7+depth*.05})`;
  ctx.lineWidth=w;ctx.shadowBlur=depth===6?8:0;ctx.shadowColor='rgba(100,181,232,.2)';
  ctx.beginPath();ctx.moveTo(x,y);ctx.lineTo(nx,ny);ctx.stroke();ctx.shadowBlur=0;
  const spread=.35+Math.random()*.1;const lenRatio=.68+Math.random()*.08;
  drawTree(ctx,nx,ny,w*.65,len*lenRatio,angle-spread,depth-1,growth);
  drawTree(ctx,nx,ny,w*.65,len*lenRatio,angle+spread,depth-1,growth);
  if(depth===2&&Math.random()>.4){drawTree(ctx,nx,ny,w*.4,len*.5,angle+(Math.random()-.5)*.8,depth-2,growth)}
}
function treeHover(e){
  const rect=treeCanvas.getBoundingClientRect();const mx=e.clientX-rect.left,my=e.clientY-rect.top;
  const popup=document.getElementById('leaf-popup');
  const nearLeaf=leaves.find(l=>Math.hypot(l.x-mx,l.y-my)<l.size*2.5);
  if(nearLeaf){popup.style.display='block';popup.style.left=mx+10+'px';popup.style.top=my-40+'px';popup.innerHTML=`<strong>${nearLeaf.person}</strong>Contributed to the Kwa Sukela community`}
  else popup.style.display='none';
}
function growLeaf(){
  const name=prompt('Enter your name to add your leaf to the Ancestor Tree:');
  if(!name)return;
  const tc=treeCanvas,cx=tc.width/2,cy=tc.height*.55;
  const angle=Math.random()*Math.PI*2,dist=50+Math.random()*120;
  leaves.push({x:cx+Math.cos(angle)*dist,y:cy-80-Math.random()*dist*.8,size:5,glow:true,person:`${name} Â· Just now`,hue:90+Math.random()*60,alpha:1});
  document.getElementById('leaf-count').textContent=leaves.length;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SCHOOLS HUB
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let currentGrade=12,currentSubject='maths';
function setGrade(g){currentGrade=g;document.querySelectorAll('.grade-pill').forEach(p=>p.classList.remove('active'));document.querySelectorAll('.grade-pill')[12-g].classList.add('active');setSubject(currentSubject)}
function setSubject(s){
  currentSubject=s;
  document.querySelectorAll('.sub-tab').forEach(t=>t.classList.remove('active'));
  const tabs=document.querySelectorAll('.sub-tab');
  const map={maths:0,science:1,english:2,zulu:3,lifesci:4};
  if(tabs[map[s]])tabs[map[s]].classList.add('active');
  renderTopics(s);
}
const topicsData={
  maths:[
    {icon:'âˆ‘',name:'Sequences & Series',sub:'Arithmetic, Geometric, Sigma notation',badge:'Paper 1',class:'maths'},
    {icon:'f(x)',name:'Functions & Inverses',sub:'Parabola, hyperbola, exponential, log',badge:'Paper 1',class:'maths'},
    {icon:"f'",name:'Differential Calculus',sub:'Limits, rules, optimisation, rates of change',badge:'Paper 1 â€” High Value',class:'maths'},
    {icon:'%',name:'Finance & Growth',sub:'Compound interest, annuities, depreciation',badge:'Paper 1',class:'maths'},
    {icon:'P()',name:'Probability',sub:'Counting principles, Venn diagrams, tree diagrams',badge:'Paper 1',class:'maths'},
    {icon:'sin',name:'Trigonometry',sub:'Compound angles, general solutions, 3D',badge:'Paper 2',class:'maths'},
    {icon:'âŠ™',name:'Euclidean Geometry',sub:'Circle theorems, proportionality theorem',badge:'Paper 2 â€” High Value',class:'maths'},
    {icon:'xy',name:'Analytical Geometry',sub:'Lines, circles, perpendicular distance',badge:'Paper 2',class:'maths'},
    {icon:'r',name:'Statistics & Regression',sub:'Scatter plots, correlation, regression line',badge:'Paper 2',class:'maths'},
  ],
  science:[
    {icon:'p',name:'Momentum & Impulse',sub:'Newton\'s laws, collisions, impulse-momentum',badge:'Physics P1',class:'science'},
    {icon:'â†‘â†“',name:'Vertical Projectile Motion',sub:'Free-fall, v-t graphs, air resistance',badge:'Physics P1',class:'science'},
    {icon:'W',name:'Work, Energy & Power',sub:'Work-energy theorem, conservation, power',badge:'Physics P1 â€” Key',class:'science'},
    {icon:'~',name:'Electrodynamics',sub:'Generators, motors, AC vs DC, transformers',badge:'Physics P1',class:'science'},
    {icon:'ğŸŒŠ',name:'Doppler Effect',sub:'Moving sources, frequency shift, applications',badge:'Physics P1',class:'science'},
    {icon:'âš—ï¸',name:'Organic Chemistry',sub:'Alkanes, alkenes, alcohols, carboxylic acids',badge:'Chemistry P2 â€” Key',class:'science'},
    {icon:'â‡Œ',name:'Chemical Equilibrium',sub:'Le Chatelier\'s principle, Kc calculations',badge:'Chemistry P2',class:'science'},
    {icon:'pH',name:'Acids & Bases',sub:'pH, titrations, buffer solutions',badge:'Chemistry P2',class:'science'},
    {icon:'eâ»',name:'Electrochemistry',sub:'Galvanic & electrolytic cells, electrode potentials',badge:'Chemistry P2',class:'science'},
  ],
  english:[
    {icon:'âœï¸',name:'Essay Writing',sub:'Argumentative, discursive, descriptive, narrative',badge:'Paper 3 â€” 100 marks',class:''},
    {icon:'ğŸ“–',name:'Comprehension',sub:'Strategies, tone, inference, vocabulary',badge:'Paper 1',class:''},
    {icon:'ğŸ“š',name:'Literature â€” Set Works',sub:'Themes, characters, language devices',badge:'Paper 2',class:''},
    {icon:'ğŸ—£ï¸',name:'Oral Presentation',sub:'Structure, delivery, language use, confidence',badge:'Ongoing',class:''},
    {icon:'âœï¸',name:'Language & Editing',sub:'Grammar, punctuation, sentence structure',badge:'Paper 1',class:''},
  ],
  zulu:[
    {icon:'ğŸ“œ',name:'Izinganekwane (Folktales)',sub:'Analysis, oral performance, structure',badge:'Iphepha 2 â€” Key',class:''},
    {icon:'ğŸ™ï¸',name:'Iziqongo (Poetry)',sub:'Devices, themes, tone, performance',badge:'Iphepha 2',class:''},
    {icon:'âœï¸',name:'Indaba & Inkondlo',sub:'Narrative essay & poetry writing',badge:'Iphepha 3',class:''},
    {icon:'ğŸ“',name:'Ulimi â€” Grammar',sub:'Izincwadi, izinkondlo, izimo zezindaba',badge:'Iphepha 1',class:''},
    {icon:'ğŸ‘‚',name:'Ukuphipha (Oral)',sub:'Listening, speaking, reading aloud',badge:'Continuous',class:''},
  ],
  lifesci:[
    {icon:'ğŸ§¬',name:'DNA, RNA & Protein Synthesis',sub:'Transcription, translation, mutations',badge:'Paper 1 â€” Key',class:'science'},
    {icon:'ğŸ§«',name:'Genetics & Inheritance',sub:'Mendel\'s laws, codominance, sex-linked traits',badge:'Paper 1 â€” Key',class:'science'},
    {icon:'ğŸ¦',name:'Evolution',sub:'Natural selection, speciation, evidence',badge:'Paper 1',class:'science'},
    {icon:'ğŸ’Š',name:'Human Endocrine System',sub:'Hormones, feedback loops, diabetes',badge:'Paper 1',class:'science'},
    {icon:'ğŸŒ¿',name:'Ecosystems & Biodiversity',sub:'Food webs, nutrient cycles, conservation',badge:'Paper 2',class:'science'},
  ]
};
function renderTopics(s){
  const grid=document.getElementById('topic-grid');if(!grid)return;
  const topics=topicsData[s]||[];
  grid.innerHTML=topics.map(t=>`
    <div class="topic-card ${t.class}" onclick="openNotes('${t.name}','${s}')">
      <div class="tc-icon" style="font-family:'JetBrains Mono',monospace;font-size:1.2rem;font-weight:700;color:${s==='maths'?'var(--blue)':s==='science'?'#9B59B6':'var(--green)}'>${t.icon}</div>
      <div class="tc-name">${t.name}</div>
      <div class="tc-sub">${t.sub}</div>
      <div class="tc-badge ${t.class}">${t.badge}</div>
    </div>`).join('');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// NOTES CONTENT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const notesContent={
  'Differential Calculus':{
    subject:'maths',
    sections:[
      {title:'KEY CONCEPTS',color:'maths',content:`<p><strong>Calculus</strong> deals with rates of change and accumulation. In Grade 12, focus on <strong>differential calculus</strong> â€” the derivative.</p>
      <p>The derivative f'(x) tells you the <strong>gradient of the tangent</strong> at any point x, and the <strong>rate of change</strong> of f(x).</p>
      <div class="formula-box"><div class="f-lbl">Definition â€” First Principles</div><div class="f-eq">f'(x) = lim[hâ†’0] [f(x+h) âˆ’ f(x)] / h</div></div>
      <div class="formula-box"><div class="f-lbl">Power Rule (Most Used)</div><div class="f-eq">If f(x) = xâ¿, then f'(x) = nÂ·xâ¿â»Â¹<br>If f(x) = axâ¿, then f'(x) = anÂ·xâ¿â»Â¹<br>If f(x) = constant, then f'(x) = 0</div></div>
      <div class="formula-box"><div class="f-lbl">Rules You Must Know</div><div class="f-eq">Sum: (f + g)' = f' + g'<br>Difference: (f âˆ’ g)' = f' âˆ’ g'<br>Chain Rule: d/dx[f(g(x))] = f'(g(x))Â·g'(x)</div></div>`},
      {title:'APPLICATIONS â€” EXAM FOCUS',color:'maths',content:`<p><strong>1. Gradient of tangent</strong> â€” find f'(x), substitute x-value</p>
      <p><strong>2. Equation of tangent line</strong> â€” use y âˆ’ yâ‚ = m(x âˆ’ xâ‚)</p>
      <p><strong>3. Stationary points</strong> â€” set f'(x) = 0, solve for x</p>
      <p><strong>4. Nature of stationary points:</strong></p>
      <div class="formula-box"><div class="f-lbl">Second Derivative Test</div><div class="f-eq">f''(x) < 0 â†’ Local MAXIMUM<br>f''(x) > 0 â†’ Local MINIMUM<br>f''(x) = 0 â†’ Point of inflection</div></div>
      <p><strong>5. Optimisation</strong> â€” write equation for quantity to maximise/minimise, differentiate, set = 0</p>
      <p><strong>6. Rates of change</strong> â€” f'(x) = rate at which f changes with respect to x</p>`},
      {title:'PRACTICE QUESTIONS',color:'',content:`
      <div class="practice-q"><div class="pq-num">Q1</div><div class="pq-q">Find f'(x) if f(x) = 3xâ´ âˆ’ 2xÂ³ + 5x âˆ’ 7</div><button class="pq-toggle" onclick="toggleAns(this)">Show Answer</button><div class="pq-ans">f'(x) = 12xÂ³ âˆ’ 6xÂ² + 5<br>Apply power rule to each term. Constants differentiate to 0.</div></div>
      <div class="practice-q"><div class="pq-num">Q2</div><div class="pq-q">Find the equation of the tangent to f(x) = xÂ³ âˆ’ 3x at x = 2</div><button class="pq-toggle" onclick="toggleAns(this)">Show Answer</button><div class="pq-ans">f(2) = 8âˆ’6 = 2, so point is (2, 2)<br>f'(x) = 3xÂ² âˆ’ 3, f'(2) = 12 âˆ’ 3 = 9<br>y âˆ’ 2 = 9(x âˆ’ 2) â†’ y = 9x âˆ’ 16</div></div>
      <div class="practice-q"><div class="pq-num">Q3</div><div class="pq-q">A box (no lid) has a square base of side x and height h. Volume = 32 cmÂ³. Find x that minimises surface area.</div><button class="pq-toggle" onclick="toggleAns(this)">Show Answer</button><div class="pq-ans">V = xÂ²h = 32 â†’ h = 32/xÂ²<br>SA = xÂ² + 4xh = xÂ² + 128/x<br>dSA/dx = 2x âˆ’ 128/xÂ² = 0<br>2xÂ³ = 128 â†’ xÂ³ = 64 â†’ x = 4 cm</div></div>`},
    ],
    tip:{icon:'ğŸ‘©â€ğŸ«',title:'Dr Sasa\'s Exam Tip',text:'Always show EVERY step in calculus â€” even if your answer is wrong, method marks save you. Write f\'(x) = ... clearly before substituting. The examiner awards marks for correct process.'}
  },
  'Momentum & Impulse':{
    subject:'science',
    sections:[
      {title:'KEY CONCEPTS',color:'science',content:`<p><strong>Momentum</strong> (p) is the product of mass and velocity. It is a <strong>vector</strong> â€” direction matters!</p>
      <div class="formula-box"><div class="f-lbl">Core Formulas</div><div class="f-eq">p = mv (kgÂ·m/s)<br>Impulse = FÎ”t = Î”p = mÎ”v<br>Î”p = p_final âˆ’ p_initial</div></div>
      <p><strong>Newton's Second Law</strong> in momentum terms: The net force equals the rate of change of momentum.</p>
      <div class="formula-box"><div class="f-lbl">Newton's 2nd Law</div><div class="f-eq">F_net = Î”p/Î”t = mÎ”v/Î”t</div></div>
      <p><strong>Law of Conservation of Momentum:</strong> In an isolated system (no external forces), total momentum before = total momentum after.</p>
      <div class="formula-box"><div class="f-lbl">Conservation of Momentum</div><div class="f-eq">Î£p_before = Î£p_after<br>mâ‚vâ‚áµ¢ + mâ‚‚vâ‚‚áµ¢ = mâ‚vâ‚f + mâ‚‚vâ‚‚f</div></div>`},
      {title:'COLLISION TYPES',color:'science',content:`<p><strong>Elastic collision:</strong> Kinetic energy AND momentum conserved.</p>
      <p><strong>Inelastic collision:</strong> Momentum conserved, KE NOT fully conserved (some converted to heat/sound).</p>
      <p><strong>Perfectly inelastic:</strong> Objects stick together after collision.</p>
      <div class="formula-box"><div class="f-lbl">Perfectly Inelastic</div><div class="f-eq">mâ‚vâ‚áµ¢ + mâ‚‚vâ‚‚áµ¢ = (mâ‚ + mâ‚‚)Â·vf</div></div>
      <p>âš ï¸ <strong>Sign convention is critical!</strong> Choose positive direction FIRST, then assign + or âˆ’ to velocities accordingly.</p>`},
      {title:'PRACTICE QUESTIONS',color:'',content:`
      <div class="practice-q"><div class="pq-num">Q1</div><div class="pq-q">A 1500 kg car moving at 20 m/s east collides with a 1000 kg car moving at 15 m/s west. They stick together. Find the final velocity.</div><button class="pq-toggle" onclick="toggleAns(this)">Show Answer</button><div class="pq-ans">Take east = positive<br>p_before = 1500(20) + 1000(âˆ’15) = 30000 âˆ’ 15000 = 15000 kgÂ·m/s<br>(1500+1000)vf = 15000<br>vf = 6 m/s east</div></div>
      <div class="practice-q"><div class="pq-num">Q2</div><div class="pq-q">A 0.3 kg ball hits a wall at 12 m/s and bounces back at 10 m/s. Contact time = 0.02 s. Find the force the wall exerts.</div><button class="pq-toggle" onclick="toggleAns(this)">Show Answer</button><div class="pq-ans">Take toward wall = positive<br>Î”p = m(vf âˆ’ vi) = 0.3(âˆ’10 âˆ’ 12) = 0.3(âˆ’22) = âˆ’6.6 NÂ·s<br>F = Î”p/Î”t = âˆ’6.6/0.02 = âˆ’330 N<br>Wall exerts 330 N away from wall on ball</div></div>`},
    ],
    tip:{icon:'ğŸ‘©â€ğŸ«',title:'Dr Sasa\'s Exam Tip',text:'The NUMBER ONE mistake is ignoring direction. Before you write a single formula, DRAW the situation and clearly define which direction is positive. Write "+ve = east (or right)" at the top of your working. Then stick to it!'}
  },
  'DNA, RNA & Protein Synthesis':{
    subject:'science',
    sections:[
      {title:'DNA STRUCTURE',color:'science',content:`<p>DNA (Deoxyribonucleic acid) is a <strong>double helix</strong> made of nucleotides. Each nucleotide has a sugar (deoxyribose), phosphate group, and one of 4 nitrogenous bases.</p>
      <div class="formula-box"><div class="f-lbl">Base Pairing Rules (DNA)</div><div class="f-eq">Adenine (A) â†” Thymine (T)  [2 hydrogen bonds]<br>Guanine (G) â†” Cytosine (C)  [3 hydrogen bonds]<br>Remember: AT-CG or "AppleTart, Good Cookie"</div></div>
      <p><strong>Chargaff's Rule:</strong> %A = %T and %G = %C in any DNA sample.</p>`},
      {title:'PROTEIN SYNTHESIS: TWO STAGES',color:'science',content:`<p><strong>Stage 1 â€” Transcription</strong> (nucleus): DNA â†’ mRNA</p>
      <p>DNA unwinds. mRNA is built using complementary base pairing (U replaces T in RNA). mRNA leaves nucleus through nuclear pore.</p>
      <div class="formula-box"><div class="f-lbl">RNA Base Pairing</div><div class="f-eq">DNA A â†’ RNA U (Uracil, not Thymine)<br>DNA T â†’ RNA A<br>DNA G â†’ RNA C<br>DNA C â†’ RNA G</div></div>
      <p><strong>Stage 2 â€” Translation</strong> (ribosome): mRNA â†’ Protein</p>
      <p>tRNA carries amino acids to the ribosome. Each mRNA codon (3 bases) is matched by a tRNA anticodon. Amino acids link to form a polypeptide chain (protein).</p>`},
      {title:'MUTATIONS',color:'science',content:`<p>A <strong>mutation</strong> is a change in the DNA base sequence.</p>
      <p><strong>Point mutations:</strong> One base changed (substitution), added (insertion), or removed (deletion).</p>
      <p>Insertion/deletion causes a <strong>frameshift</strong> â€” all codons downstream shift, often drastically changing the protein.</p>
      <p>Substitution may be <strong>silent</strong> (same amino acid due to degeneracy of genetic code) or cause an <strong>amino acid change</strong>.</p>`,},
      {title:'PRACTICE QUESTIONS',color:'',content:`
      <div class="practice-q"><div class="pq-num">Q1</div><div class="pq-q">A DNA template strand reads: 3'âˆ’ATCGGTACCAâˆ’5'. Write the corresponding mRNA sequence (5'â†’3').</div><button class="pq-toggle" onclick="toggleAns(this)">Show Answer</button><div class="pq-ans">mRNA (5'â†’3'): UAGCCAUGGU<br>Remember: Tâ†’A, Aâ†’U, Gâ†’C, Câ†’G. T in DNA becomes U in mRNA.</div></div>
      <div class="practice-q"><div class="pq-num">Q2</div><div class="pq-q">A gene has 24% Adenine. What % is Guanine?</div><button class="pq-toggle" onclick="toggleAns(this)">Show Answer</button><div class="pq-ans">A = T = 24%, so A+T = 48%<br>G+C = 100% âˆ’ 48% = 52%<br>G = C = 26%</div></div>`},
    ],
    tip:{icon:'ğŸ‘©â€ğŸ«',title:'Dr Sasa\'s Exam Tip',text:'Students lose marks confusing the template strand direction. Always check if the question gives you the template (3\'â†’5\') or coding (5\'â†’3\') strand. The mRNA is complementary and antiparallel to the TEMPLATE strand. Draw a quick diagram â€” it takes 10 seconds and saves your marks.'}
  },
  'Essay Writing':{
    subject:'english',
    sections:[
      {title:'ESSAY TYPES & STRUCTURES',color:'',content:`<p>Paper 3 awards <strong>100 marks</strong> and is entirely essays. Know all 4 types cold.</p>
      <p><strong>Argumentative</strong> â€” one clear stance, defend it with evidence. No "on the other hand." Persuasive, assertive voice.</p>
      <p><strong>Discursive</strong> â€” balanced discussion of both sides. Balanced, analytical voice. Conclude with your informed view.</p>
      <p><strong>Narrative</strong> â€” tell a story. Vivid sensory detail, dialogue, rising action, climax, resolution.</p>
      <p><strong>Descriptive</strong> â€” create a scene/mood. Five senses. No plot needed. Show, don't tell.</p>
      <div class="formula-box"><div class="f-lbl">Universal Essay Structure</div><div class="f-eq">Introduction: Hook + context + thesis/direction (3â€“5 sentences)<br>Body P1: Topic sentence + evidence + explanation + link<br>Body P2: Topic sentence + evidence + explanation + link<br>Body P3: Topic sentence + evidence + explanation + link<br>Conclusion: Restate thesis + summary + clincher statement</div></div>`},
      {title:'LANGUAGE & STYLE MARKS',color:'',content:`<p>Markers award separate marks for <strong>content</strong> and <strong>language</strong>. You can score high on one and low on another â€” work on both.</p>
      <p><strong>Vocabulary</strong> â€” Replace weak words. Instead of "good," use: compelling, poignant, astute, formidable. Instead of "said," use: asserted, remarked, whispered, declared.</p>
      <p><strong>Sentence variety</strong> â€” Mix short punchy sentences with longer complex ones. Short sentences create impact. Longer, more elaborate sentences provide context, depth and sophistication.</p>
      <p><strong>Linking words</strong> â€” Furthermore, consequently, in contrast, notwithstanding, despite this, it follows that...</p>`},
      {title:'PRACTICE QUESTIONS',color:'',content:`<div class="practice-q"><div class="pq-num">Q1</div><div class="pq-q">Write an argumentative essay: "Social media does more harm than good for South African youth." Plan your essay in point form first.</div><button class="pq-toggle" onclick="toggleAns(this)">Show Answer</button><div class="pq-ans">Intro: Define position â€” agree. Social media causes harm outweighing benefit.<br>P1: Mental health â€” comparison culture, anxiety, depression stats SA<br>P2: Misinformation spreads rapidly â€” political/health dangers<br>P3: Distraction from education â€” screen time, poor academic performance<br>Conclusion: Benefits (connection, information) don't offset mental health crisis</div></div>`},
    ],
    tip:{icon:'ğŸ‘©â€ğŸ«',title:'Dr Sasa\'s Exam Tip',text:'The first sentence of your essay is everything. I\'ve marked hundreds of essays â€” the introduction tells me exactly what mark this student will get. Spend 3 minutes crafting your opening line. Start with a surprising fact, a provocative question, or a vivid image. Never start with "In this essay I will discuss..."'}
  },
  'Izinganekwane (Folktales)':{
    subject:'zulu',
    sections:[
      {title:'IZINGANEKWANE â€” WHAT YOU MUST KNOW',color:'',content:`<p><strong>Izinganekwane</strong> (singular: inganekwane) are traditional Zulu folktales told orally across generations. They serve to entertain, teach values, explain natural phenomena and transmit cultural wisdom.</p>
      <p><strong>Key structural features:</strong></p>
      <p>â€¢ <strong>Opening formula:</strong> "Kwasukasukela..." â€” signals the story is beginning</p>
      <p>â€¢ <strong>Characters:</strong> Often animals with human traits (anthropomorphism), heroes, tricksters, ogres (izilwane), ancestors</p>
      <p>â€¢ <strong>Conflict:</strong> Usually moral â€” wisdom vs foolishness, greed vs generosity, courage vs cowardice</p>
      <p>â€¢ <strong>Resolution:</strong> Always teaches a moral lesson (isifundo)</p>
      <p>â€¢ <strong>Closing formula:</strong> Audience participation, call and response</p>`},
      {title:'LITERARY DEVICES IN IZINGANEKWANE',color:'',content:`<p><strong>Inhlonipho</strong> â€” respectful language used when characters address elders</p>
      <p><strong>Izaga</strong> (proverbs) â€” woven into the narrative to reinforce the lesson</p>
      <p><strong>Izifengqo</strong> (similes and metaphors) â€” comparing to animals, nature</p>
      <p><strong>Repetition</strong> â€” events often repeat in 3s, building tension and rhythm</p>
      <p><strong>Onomatopoeia</strong> â€” sound words that mimic animals and nature</p>
      <p>When analysing, always link the device to its <strong>purpose and effect</strong> â€” not just identifying it.</p>`},
      {title:'PERFORMANCE ELEMENTS',color:'',content:`<p>Izinganekwane are ORAL â€” performance is part of the text. Know these for oral questions:</p>
      <p>â€¢ <strong>Tone</strong> â€” shifts with character (playful for trickster, deep for elder)</p>
      <p>â€¢ <strong>Pace</strong> â€” slow for suspense, fast for action</p>
      <p>â€¢ <strong>Audience response</strong> â€” "Kwa sukela!" â†’ "Sukela!" call and response</p>
      <p>â€¢ <strong>Gesture and movement</strong> â€” embodying animals and characters</p>`,},
    ],
    tip:{icon:'ğŸ‘©â€ğŸ«',title:'Dr Sasa\'s Exam Tip',text:'Izinganekwane questions in the exam always ask you to analyse AND evaluate. Don\'t just retell â€” analyse the LANGUAGE and its effect. Then evaluate whether the storytelling achieves its purpose. Examiners love when you connect the folktale to contemporary society â€” it shows deep cultural understanding.'}
  }
};

function openNotes(topic,subject){
  const data=notesContent[topic];
  const nm=document.getElementById('notes-overlay');
  document.getElementById('nm-title').textContent=topic;
  if(!data){document.getElementById('nm-body').innerHTML=`<div style="padding:2rem;text-align:center"><p style="color:var(--i60);font-style:italic;font-family:'Cormorant Garamond',serif;font-size:1.1rem">Full notes for <strong>${topic}</strong> are being prepared by Dr Sasa's team. Check back soon!</p><div class="tip-box" style="margin:1.5rem 0"><div class="tip-icon">ğŸ‘©â€ğŸ«</div><div><div class="tip-lbl">Dr Sasa says</div><div class="tip-text">This topic is part of your ${subject==='maths'?'Mathematics Paper':'Physical Sciences'} curriculum. Master your formula sheet and past papers while we finish these notes.</div></div></div></div>`;nm.classList.add('open');return}
  let html='';
  data.sections.forEach(s=>{
    html+=`<div class="nm-section"><div class="nm-section-title ${s.color}">${s.title}</div>${s.content}</div>`;
  });
  if(data.tip){html+=`<div class="tip-box"><div class="tip-icon">${data.tip.icon}</div><div><div class="tip-lbl">${data.tip.title}</div><div class="tip-text">${data.tip.text}</div></div></div>`}
  document.getElementById('nm-body').innerHTML=html;nm.classList.add('open');
}
function closeNotes(){document.getElementById('notes-overlay').classList.remove('open')}
function toggleAns(btn){const ans=btn.nextElementSibling;const showing=ans.style.display==='block';ans.style.display=showing?'none':'block';btn.textContent=showing?'Show Answer':'Hide Answer'}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// AUDIO NOTIFICATIONS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
document.querySelectorAll('.ac-notify').forEach(b=>b.addEventListener('click',function(){this.textContent='âœ“ You\'ll be notified!';this.style.color='#27AE60';this.style.cursor='default'}));

// Start
window.addEventListener('resize',()=>{if(treeCanvas){treeCanvas.width=treeCanvas.offsetWidth;treeCanvas.height=treeCanvas.offsetHeight}});
</script>
</body>
</html>
